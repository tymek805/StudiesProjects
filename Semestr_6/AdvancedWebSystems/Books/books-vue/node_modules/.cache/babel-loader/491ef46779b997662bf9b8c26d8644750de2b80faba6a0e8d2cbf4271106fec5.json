{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.every.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.iterator.reduce.js\";\nimport \"core-js/modules/es.iterator.some.js\";\nimport \"core-js/modules/es.set.difference.v2.js\";\nimport \"core-js/modules/es.set.intersection.v2.js\";\nimport \"core-js/modules/es.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/es.set.is-subset-of.v2.js\";\nimport \"core-js/modules/es.set.is-superset-of.v2.js\";\nimport \"core-js/modules/es.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/es.set.union.v2.js\";\nimport { defineComponent, computed, createElementBlock, openBlock, normalizeClass, renderSlot, unref, useSlots, ref, watch, createBlock, normalizeProps, guardReactiveProps, withCtx, withDirectives, createVNode, createCommentVNode, Fragment, renderList, mergeProps, createTextVNode, toDisplayString, vShow, createElementVNode, mergeModels, useModel, onMounted, createSlots } from \"vue\";\nimport { g as get, p as pick, s as set } from \"./object-BWoyyA2y.mjs\";\nimport { _ as _sfc_main$8 } from \"./BTableSimple.vue_vue_type_script_setup_true_lang-Dl-5AMhv.mjs\";\nimport { u as useDefaults } from \"./useDefaults-DANje4tM.mjs\";\nimport { a as titleCase, s as startCase } from \"./stringUtils-mwxHpj6j.mjs\";\nimport { u as useId } from \"./useId-BzCLXIGF.mjs\";\nimport { u as useToNumber } from \"./index-CLgoGrAV.mjs\";\nconst formatItem = (item, fieldKey, formatter) => {\n  const val = get(item, fieldKey);\n  return formatter && typeof formatter === \"function\" ? formatter(val, fieldKey, item) : val;\n};\nconst isTableItem = value => typeof value === \"object\" && value !== null;\nconst isTableField = value => typeof value === \"object\" && value !== null && \"key\" in value;\nconst _sfc_main$7 = /* @__PURE__ */defineComponent({\n  __name: \"BTbody\",\n  props: {\n    variant: {\n      default: null\n    }\n  },\n  setup(__props) {\n    const _props = __props;\n    const props = useDefaults(_props, \"BTbody\");\n    const computedClasses = computed(() => ({\n      [`thead-${props.variant}`]: props.variant !== null\n    }));\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"tbody\", {\n        class: normalizeClass(computedClasses.value)\n      }, [renderSlot(_ctx.$slots, \"default\")], 2);\n    };\n  }\n});\nconst _hoisted_1$3 = [\"scope\", \"colspan\", \"rowspan\", \"data-label\"];\nconst _hoisted_2$3 = {\n  key: 0\n};\nconst _sfc_main$6 = /* @__PURE__ */defineComponent({\n  __name: \"BTd\",\n  props: {\n    colspan: {\n      default: void 0\n    },\n    rowspan: {\n      default: void 0\n    },\n    stackedHeading: {\n      default: void 0\n    },\n    stickyColumn: {\n      type: Boolean,\n      default: false\n    },\n    variant: {\n      default: null\n    }\n  },\n  setup(__props) {\n    const _props = __props;\n    const props = useDefaults(_props, \"BTd\");\n    const computedClasses = computed(() => ({\n      [`table-${props.variant}`]: props.variant !== null,\n      \"b-table-sticky-column\": props.stickyColumn,\n      \"table-b-table-default\": props.stickyColumn && props.variant === null\n    }));\n    const scope = computed(() => props.colspan ? \"colspan\" : props.rowspan ? \"rowspan\" : \"col\");\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"td\", {\n        scope: scope.value,\n        class: normalizeClass(computedClasses.value),\n        colspan: unref(props).colspan,\n        rowspan: unref(props).rowspan,\n        \"data-label\": unref(props).stackedHeading\n      }, [unref(props).stackedHeading ? (openBlock(), createElementBlock(\"div\", _hoisted_2$3, [renderSlot(_ctx.$slots, \"default\")])) : renderSlot(_ctx.$slots, \"default\", {\n        key: 1\n      })], 10, _hoisted_1$3);\n    };\n  }\n});\nconst _sfc_main$5 = /* @__PURE__ */defineComponent({\n  __name: \"BTfoot\",\n  props: {\n    variant: {\n      default: null\n    }\n  },\n  setup(__props) {\n    const _props = __props;\n    const props = useDefaults(_props, \"BTfoot\");\n    const computedClasses = computed(() => ({\n      [`table-${props.variant}`]: props.variant !== null\n    }));\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"tfoot\", {\n        class: normalizeClass(computedClasses.value)\n      }, [renderSlot(_ctx.$slots, \"default\")], 2);\n    };\n  }\n});\nconst _hoisted_1$2 = [\"scope\", \"colspan\", \"rowspan\", \"data-label\"];\nconst _hoisted_2$2 = {\n  key: 0\n};\nconst _sfc_main$4 = /* @__PURE__ */defineComponent({\n  __name: \"BTh\",\n  props: {\n    colspan: {\n      default: void 0\n    },\n    rowspan: {\n      default: void 0\n    },\n    stackedHeading: {\n      default: void 0\n    },\n    stickyColumn: {\n      type: Boolean,\n      default: false\n    },\n    variant: {\n      default: null\n    }\n  },\n  setup(__props) {\n    const _props = __props;\n    const props = useDefaults(_props, \"BTh\");\n    const computedClasses = computed(() => ({\n      [`table-${props.variant}`]: props.variant !== null,\n      \"b-table-sticky-column\": props.stickyColumn,\n      \"table-b-table-default\": props.stickyColumn && props.variant === null\n    }));\n    const scope = computed(() => props.colspan ? \"colspan\" : props.rowspan ? \"rowspan\" : \"col\");\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"th\", {\n        scope: scope.value,\n        class: normalizeClass(computedClasses.value),\n        colspan: unref(props).colspan,\n        rowspan: unref(props).rowspan,\n        \"data-label\": unref(props).stackedHeading\n      }, [unref(props).stackedHeading !== void 0 ? (openBlock(), createElementBlock(\"div\", _hoisted_2$2, [renderSlot(_ctx.$slots, \"default\")])) : renderSlot(_ctx.$slots, \"default\", {\n        key: 1\n      })], 10, _hoisted_1$2);\n    };\n  }\n});\nconst _sfc_main$3 = /* @__PURE__ */defineComponent({\n  __name: \"BThead\",\n  props: {\n    variant: {\n      default: null\n    }\n  },\n  setup(__props) {\n    const _props = __props;\n    const props = useDefaults(_props, \"BThead\");\n    const computedClasses = computed(() => ({\n      [`table-${props.variant}`]: props.variant !== null\n    }));\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"thead\", {\n        class: normalizeClass(computedClasses.value)\n      }, [renderSlot(_ctx.$slots, \"default\")], 2);\n    };\n  }\n});\nconst _sfc_main$2 = /* @__PURE__ */defineComponent({\n  __name: \"BTr\",\n  props: {\n    variant: {\n      default: null\n    }\n  },\n  setup(__props) {\n    const _props = __props;\n    const props = useDefaults(_props, \"BTr\");\n    const computedClasses = computed(() => ({\n      [`table-${props.variant}`]: props.variant !== null\n    }));\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"tr\", {\n        class: normalizeClass(computedClasses.value)\n      }, [renderSlot(_ctx.$slots, \"default\")], 2);\n    };\n  }\n});\nconst getTableFieldHeadLabel = field => typeof field === \"string\" ? titleCase(field) : field.label !== void 0 ? field.label : typeof field.key === \"string\" ? titleCase(field.key) : field.key;\nconst btableSimpleProps = Object.freeze(Object.keys({\n  bordered: 0,\n  borderless: 0,\n  borderVariant: 0,\n  captionTop: 0,\n  dark: 0,\n  fixed: 0,\n  hover: 0,\n  id: 0,\n  noBorderCollapse: 0,\n  outlined: 0,\n  responsive: 0,\n  small: 0,\n  stacked: 0,\n  stickyHeader: 0,\n  striped: 0,\n  stripedColumns: 0,\n  variant: 0,\n  tableAttrs: 0,\n  tableClass: 0\n}));\nconst btableLiteProps = Object.freeze(Object.keys({\n  align: 0,\n  caption: 0,\n  detailsTdClass: 0,\n  fieldColumnClass: 0,\n  fields: 0,\n  footClone: 0,\n  footRowVariant: 0,\n  footVariant: 0,\n  headRowVariant: 0,\n  headVariant: 0,\n  items: 0,\n  labelStacked: 0,\n  modelValue: 0,\n  primaryKey: 0,\n  tbodyClass: 0,\n  tbodyTrAttrs: 0,\n  tbodyTrClass: 0,\n  tfootClass: 0,\n  tfootTrClass: 0,\n  theadClass: 0,\n  theadTrClass: 0\n}));\nconst getDataLabelAttr = (props, label) => props.stacked && props.labelStacked !== true ? {\n  \"data-label\": label\n} : void 0;\nconst TABLE_TAG_NAMES = [\"TD\", \"TH\", \"TR\"];\nconst eventFilter = [\"a\", \"a *\",\n// Include content inside links\n\"button\", \"button *\",\n// Include content inside buttons\n\"input:not(.disabled):not([disabled])\", \"select:not(.disabled):not([disabled])\", \"textarea:not(.disabled):not([disabled])\", '[role=\"link\"]', '[role=\"link\"] *', '[role=\"button\"]', '[role=\"button\"] *', \"[tabindex]:not(.disabled):not([disabled])\"].join(\",\");\nconst filterEvent = event => {\n  if (!event || !event.target) {\n    return false;\n  }\n  const el = event.target;\n  if (\"disabled\" in el && el.disabled || TABLE_TAG_NAMES.indexOf(el.tagName) !== -1) {\n    return false;\n  }\n  if (el.closest(\".dropdown-menu\")) return true;\n  const label = el.tagName === \"LABEL\" ? el : el.closest(\"label\");\n  if (label) {\n    const labelFor = label.getAttribute(\"for\");\n    const input = labelFor ? document.getElementById(labelFor) : label.querySelector(\"input, select, textarea\");\n    if (input && !input.disabled) {\n      return true;\n    }\n  }\n  return el.matches(eventFilter);\n};\nconst _hoisted_1$1 = {\n  key: 0,\n  class: \"b-table-stacked-label\"\n};\nconst _hoisted_2$1 = {\n  class: \"d-inline-flex flex-nowrap align-items-center gap-1\"\n};\nconst _hoisted_3$1 = {\n  key: 2\n};\nconst _sfc_main$1 = /* @__PURE__ */defineComponent({\n  __name: \"BTableLite\",\n  props: {\n    align: {\n      default: void 0\n    },\n    caption: {\n      default: void 0\n    },\n    detailsTdClass: {\n      default: void 0\n    },\n    fieldColumnClass: {\n      type: [Function, String, Object, Array],\n      default: void 0\n    },\n    fields: {\n      default: () => []\n    },\n    footClone: {\n      type: Boolean,\n      default: false\n    },\n    footRowVariant: {\n      default: void 0\n    },\n    footVariant: {\n      default: void 0\n    },\n    headRowVariant: {\n      default: void 0\n    },\n    headVariant: {\n      default: void 0\n    },\n    items: {\n      default: () => []\n    },\n    labelStacked: {\n      type: Boolean,\n      default: false\n    },\n    modelValue: {\n      default: void 0\n    },\n    primaryKey: {\n      default: void 0\n    },\n    tbodyClass: {\n      default: void 0\n    },\n    tbodyTrAttrs: {\n      type: [Function, Object],\n      default: void 0\n    },\n    tbodyTrClass: {\n      type: [Function, String, Array, Object],\n      default: void 0\n    },\n    tfootClass: {\n      default: void 0\n    },\n    tfootTrClass: {\n      default: void 0\n    },\n    theadClass: {\n      default: void 0\n    },\n    theadTrClass: {\n      default: void 0\n    },\n    bordered: {\n      type: Boolean,\n      default: void 0\n    },\n    borderless: {\n      type: Boolean,\n      default: void 0\n    },\n    borderVariant: {\n      default: void 0\n    },\n    captionTop: {\n      type: Boolean,\n      default: void 0\n    },\n    dark: {\n      type: Boolean,\n      default: void 0\n    },\n    fixed: {\n      type: Boolean,\n      default: void 0\n    },\n    hover: {\n      type: Boolean,\n      default: void 0\n    },\n    id: {\n      default: void 0\n    },\n    noBorderCollapse: {\n      type: Boolean,\n      default: void 0\n    },\n    outlined: {\n      type: Boolean,\n      default: void 0\n    },\n    responsive: {\n      type: [Boolean, String],\n      default: void 0\n    },\n    small: {\n      type: Boolean,\n      default: void 0\n    },\n    stacked: {\n      type: [Boolean, String],\n      default: void 0\n    },\n    stickyHeader: {\n      type: [Boolean, String, Number],\n      default: void 0\n    },\n    striped: {\n      type: Boolean,\n      default: void 0\n    },\n    stripedColumns: {\n      type: Boolean,\n      default: void 0\n    },\n    variant: {\n      default: void 0\n    },\n    tableAttrs: {},\n    tableClass: {\n      default: void 0\n    }\n  },\n  emits: [\"head-clicked\", \"row-clicked\", \"row-dblclicked\", \"row-contextmenu\", \"row-hovered\", \"row-unhovered\", \"row-middle-clicked\"],\n  setup(__props, {\n    emit: __emit\n  }) {\n    const _props = __props;\n    const props = useDefaults(_props, \"BTableLite\");\n    const emit = __emit;\n    const slots = useSlots();\n    const computedId = useId(() => props.id);\n    const generateDetailsItem = item => [item, item._showDetails];\n    const detailsMap = ref(/* @__PURE__ */new WeakMap());\n    watch(() => props.items, items => {\n      items.forEach(item => {\n        if (!isTableItem(item)) return;\n        detailsMap.value.set(...generateDetailsItem(item));\n      });\n    }, {\n      deep: true,\n      immediate: true\n    });\n    const computedTableClasses = computed(() => [props.tableClass, {\n      [`align-${props.align}`]: props.align !== void 0\n    }]);\n    const computedFields = computed(() => {\n      if (!props.fields.length && props.items.length) {\n        const [firstItem] = props.items;\n        if (firstItem && (isTableItem(firstItem) || Array.isArray(firstItem))) {\n          return Object.keys(firstItem).map(k => {\n            const label = startCase(k);\n            return {\n              key: k,\n              label,\n              tdAttr: getDataLabelAttr(props, label)\n            };\n          });\n        }\n        return [{\n          key: \"\",\n          _noHeader: true\n        }];\n      }\n      return props.fields.map(f => {\n        if (isTableField(f)) {\n          const label2 = f.label ?? startCase(f.key);\n          return {\n            ...f,\n            tdAttr: {\n              ...getDataLabelAttr(props, label2),\n              ...f.tdAttr\n            }\n          };\n        }\n        const label = startCase(f);\n        return {\n          key: f,\n          label,\n          tdAttr: getDataLabelAttr(props, label)\n        };\n      });\n    });\n    const computedFieldsTotal = computed(() => computedFields.value.length);\n    const showComputedHeaders = computed(() => {\n      if (computedFieldsTotal.value > 0 && computedFields.value.every(el => el._noHeader === true)) return false;\n      return true;\n    });\n    const footerProps = computed(() => ({\n      variant: props.footVariant,\n      class: props.tfootClass\n    }));\n    const itemAttributes = (item, fieldKey, attr) => {\n      const val = get(item, fieldKey);\n      return attr && typeof attr === \"function\" ? attr(val, fieldKey, item) : attr;\n    };\n    const callThAttr = (item, field, type) => {\n      const fieldKey = String(field.key);\n      const val = get(item, fieldKey);\n      return field.thAttr && typeof field.thAttr === \"function\" ? field.thAttr(val, fieldKey, item, type) : field.thAttr;\n    };\n    const headerClicked = (field, event, isFooter = false) => {\n      emit(\"head-clicked\", field.key, field, event, isFooter);\n    };\n    const toggleRowDetails = tr => {\n      if (isTableItem(tr)) {\n        const prevValue = detailsMap.value.get(tr);\n        detailsMap.value.set(tr, !prevValue);\n        tr._showDetails = !prevValue;\n      }\n    };\n    const getFieldColumnClasses = field => [field.class, field.thClass, {\n      \"b-table-sticky-column\": field.stickyColumn\n    }, props.fieldColumnClass ? typeof props.fieldColumnClass === \"function\" ? props.fieldColumnClass(field) : props.fieldColumnClass : null];\n    const getFieldRowClasses = (field, tr) => {\n      var _a, _b;\n      const val = get(tr, String(field.key));\n      return [field.class, typeof field.tdClass === \"function\" ? field.tdClass(val, String(field.key), tr) : field.tdClass, (isTableItem(tr) ? (_a = tr._cellVariants) == null ? void 0 : _a[field.key] : false) ? `table-${(_b = tr._cellVariants) == null ? void 0 : _b[field.key]}` : null, {\n        \"b-table-sticky-column\": field.stickyColumn\n      }];\n    };\n    const handleMiddleClick = (item, itemIndex, event) => {\n      if (event.button === 1 && !filterEvent(event)) {\n        emit(\"row-middle-clicked\", item, itemIndex, event);\n      }\n    };\n    const callTbodyTrAttrs = (item, type) => props.tbodyTrAttrs ? typeof props.tbodyTrAttrs === \"function\" ? props.tbodyTrAttrs(item, type) : props.tbodyTrAttrs : null;\n    const getRowClasses = (item, type) => props.tbodyTrClass ? typeof props.tbodyTrClass === \"function\" ? props.tbodyTrClass(item, type) : props.tbodyTrClass : null;\n    const generateTableRowId = primaryKeyValue => `${computedId.value}__row_${primaryKeyValue}`;\n    const computedSimpleProps = computed(() => ({\n      ...pick(props, btableSimpleProps),\n      tableClass: computedTableClasses.value,\n      id: computedId.value\n    }));\n    return (_ctx, _cache) => {\n      return openBlock(), createBlock(_sfc_main$8, normalizeProps(guardReactiveProps(computedSimpleProps.value)), {\n        default: withCtx(() => [withDirectives(createVNode(_sfc_main$3, {\n          variant: unref(props).headVariant,\n          class: normalizeClass(unref(props).theadClass)\n        }, {\n          default: withCtx(() => [renderSlot(_ctx.$slots, \"thead-top\", {\n            columns: computedFieldsTotal.value,\n            fields: computedFields.value\n          }), createVNode(_sfc_main$2, {\n            variant: unref(props).headRowVariant,\n            class: normalizeClass(unref(props).theadTrClass)\n          }, {\n            default: withCtx(() => [(openBlock(true), createElementBlock(Fragment, null, renderList(computedFields.value, field => {\n              return openBlock(), createBlock(_sfc_main$4, mergeProps({\n                key: field.key,\n                scope: \"col\",\n                class: getFieldColumnClasses(field),\n                title: field.headerTitle,\n                variant: field.variant,\n                abbr: field.headerAbbr,\n                style: field.thStyle,\n                ref_for: true\n              }, callThAttr(null, field, \"top\"), {\n                onClick: $event => headerClicked(field, $event)\n              }), {\n                default: withCtx(() => [renderSlot(_ctx.$slots, slots[`head(${String(field.key)})`] ? `head(${String(field.key)})` : \"head()\", {\n                  label: field.label,\n                  column: field.key,\n                  field,\n                  isFoot: false\n                }, () => [createTextVNode(toDisplayString(unref(getTableFieldHeadLabel)(field)), 1)])]),\n                _: 2\n              }, 1040, [\"class\", \"title\", \"variant\", \"abbr\", \"style\", \"onClick\"]);\n            }), 128))]),\n            _: 3\n          }, 8, [\"variant\", \"class\"]), slots[\"thead-sub\"] ? (openBlock(), createBlock(_sfc_main$2, {\n            key: 0\n          }, {\n            default: withCtx(() => [(openBlock(true), createElementBlock(Fragment, null, renderList(computedFields.value, field => {\n              return openBlock(), createBlock(_sfc_main$6, {\n                key: field.key,\n                scope: \"col\",\n                variant: field.variant,\n                class: normalizeClass([field.class, field.thClass])\n              }, {\n                default: withCtx(() => [renderSlot(_ctx.$slots, \"thead-sub\", {\n                  items: unref(props).items,\n                  fields: computedFields.value,\n                  field\n                }, () => [createTextVNode(toDisplayString(field.label), 1)])]),\n                _: 2\n              }, 1032, [\"variant\", \"class\"]);\n            }), 128))]),\n            _: 3\n          })) : createCommentVNode(\"\", true)]),\n          _: 3\n        }, 8, [\"variant\", \"class\"]), [[vShow, showComputedHeaders.value]]), createVNode(_sfc_main$7, {\n          class: normalizeClass(unref(props).tbodyClass)\n        }, {\n          default: withCtx(() => [renderSlot(_ctx.$slots, \"custom-body\", {\n            fields: computedFields.value,\n            items: unref(props).items,\n            columns: computedFieldsTotal.value\n          }, () => [!unref(props).stacked && slots[\"top-row\"] ? (openBlock(), createBlock(_sfc_main$2, mergeProps({\n            key: 0,\n            class: getRowClasses(null, \"row-top\")\n          }, callTbodyTrAttrs(null, \"row-top\")), {\n            default: withCtx(() => [renderSlot(_ctx.$slots, \"top-row\", {\n              columns: computedFieldsTotal.value,\n              fields: computedFields.value\n            })]),\n            _: 3\n          }, 16, [\"class\"])) : createCommentVNode(\"\", true), (openBlock(true), createElementBlock(Fragment, null, renderList(unref(props).items, (item, itemIndex) => {\n            return openBlock(), createElementBlock(Fragment, {\n              key: unref(props).primaryKey && unref(get)(item, unref(props).primaryKey) ? unref(get)(item, unref(props).primaryKey) : itemIndex\n            }, [createVNode(_sfc_main$2, mergeProps({\n              id: unref(props).primaryKey && unref(get)(item, unref(props).primaryKey) ? generateTableRowId(unref(get)(item, unref(props).primaryKey)) : void 0,\n              class: getRowClasses(item, \"row\"),\n              variant: unref(isTableItem)(item) ? item._rowVariant : void 0,\n              ref_for: true\n            }, callTbodyTrAttrs(item, \"row\"), {\n              onClick: $event => !unref(filterEvent)($event) && emit(\"row-clicked\", item, itemIndex, $event),\n              onDblclick: $event => !unref(filterEvent)($event) && emit(\"row-dblclicked\", item, itemIndex, $event),\n              onContextmenu: $event => !unref(filterEvent)($event) && emit(\"row-contextmenu\", item, itemIndex, $event),\n              onMouseenter: $event => !unref(filterEvent)($event) && emit(\"row-hovered\", item, itemIndex, $event),\n              onMouseleave: $event => !unref(filterEvent)($event) && emit(\"row-unhovered\", item, itemIndex, $event),\n              onMousedown: $event => handleMiddleClick(item, itemIndex, $event)\n            }), {\n              default: withCtx(() => [(openBlock(true), createElementBlock(Fragment, null, renderList(computedFields.value, field => {\n                var _a;\n                return openBlock(), createBlock(_sfc_main$6, mergeProps({\n                  key: field.key,\n                  variant: (unref(isTableItem)(item) ? (_a = item._cellVariants) == null ? void 0 : _a[field.key] : false) ? null : field.variant,\n                  class: getFieldRowClasses(field, item),\n                  ref_for: true\n                }, itemAttributes(item, String(field.key), field.tdAttr)), {\n                  default: withCtx(() => [unref(props).stacked && unref(props).labelStacked ? (openBlock(), createElementBlock(\"label\", _hoisted_1$1, toDisplayString(unref(getTableFieldHeadLabel)(field)), 1)) : createCommentVNode(\"\", true), renderSlot(_ctx.$slots, slots[`cell(${String(field.key)})`] ? `cell(${String(field.key)})` : \"cell()\", {\n                    value: unref(formatItem)(item, String(field.key), field.formatter),\n                    unformatted: unref(get)(item, String(field.key)),\n                    index: itemIndex,\n                    item,\n                    field,\n                    items: _ctx.items,\n                    toggleDetails: () => toggleRowDetails(item),\n                    detailsShowing: unref(isTableItem)(item) ? detailsMap.value.get(item) ?? false : false\n                  }, () => [!slots[`cell(${String(field.key)})`] && !slots[\"cell()\"] ? (openBlock(), createElementBlock(Fragment, {\n                    key: 0\n                  }, [createTextVNode(toDisplayString(unref(formatItem)(item, String(field.key), field.formatter)), 1)], 64)) : createCommentVNode(\"\", true)])]),\n                  _: 2\n                }, 1040, [\"variant\", \"class\"]);\n              }), 128))]),\n              _: 2\n            }, 1040, [\"id\", \"class\", \"variant\", \"onClick\", \"onDblclick\", \"onContextmenu\", \"onMouseenter\", \"onMouseleave\", \"onMousedown\"]), unref(isTableItem)(item) && detailsMap.value.get(item) === true && slots[\"row-details\"] ? (openBlock(), createElementBlock(Fragment, {\n              key: 0\n            }, [createVNode(_sfc_main$2, {\n              \"aria-hidden\": \"true\",\n              role: \"presentation\",\n              class: \"d-none\"\n            }), createVNode(_sfc_main$2, mergeProps({\n              class: getRowClasses(item, \"row-details\"),\n              variant: item._rowVariant,\n              ref_for: true\n            }, callTbodyTrAttrs(item, \"row-details\")), {\n              default: withCtx(() => [createVNode(_sfc_main$6, {\n                colspan: computedFieldsTotal.value,\n                class: normalizeClass(_ctx.detailsTdClass)\n              }, {\n                default: withCtx(() => [renderSlot(_ctx.$slots, \"row-details\", {\n                  item,\n                  toggleDetails: () => toggleRowDetails(item),\n                  fields: computedFields.value,\n                  index: itemIndex\n                })]),\n                _: 2\n              }, 1032, [\"colspan\", \"class\"])]),\n              _: 2\n            }, 1040, [\"class\", \"variant\"])], 64)) : createCommentVNode(\"\", true)], 64);\n          }), 128)), !unref(props).stacked && slots[\"bottom-row\"] ? (openBlock(), createBlock(_sfc_main$2, mergeProps({\n            key: 1,\n            class: [\"bottom-row\", getRowClasses(null, \"row-bottom\")]\n          }, callTbodyTrAttrs(null, \"row-bottom\")), {\n            default: withCtx(() => [renderSlot(_ctx.$slots, \"bottom-row\", {\n              columns: computedFieldsTotal.value,\n              fields: computedFields.value\n            })]),\n            _: 3\n          }, 16, [\"class\"])) : createCommentVNode(\"\", true)])]),\n          _: 3\n        }, 8, [\"class\"]), unref(props).footClone ? (openBlock(), createBlock(_sfc_main$5, normalizeProps(mergeProps({\n          key: 0\n        }, footerProps.value)), {\n          default: withCtx(() => [createVNode(_sfc_main$2, {\n            variant: unref(props).footRowVariant,\n            class: normalizeClass(unref(props).tfootTrClass)\n          }, {\n            default: withCtx(() => [(openBlock(true), createElementBlock(Fragment, null, renderList(computedFields.value, field => {\n              return openBlock(), createBlock(_sfc_main$4, mergeProps({\n                key: field.key,\n                scope: \"col\",\n                class: getFieldColumnClasses(field),\n                title: field.headerTitle,\n                abbr: field.headerAbbr,\n                style: field.thStyle,\n                variant: field.variant,\n                ref_for: true\n              }, callThAttr(null, field, \"bottom\"), {\n                onClick: $event => headerClicked(field, $event, true)\n              }), {\n                default: withCtx(() => [createElementVNode(\"div\", _hoisted_2$1, [createElementVNode(\"div\", null, [renderSlot(_ctx.$slots, slots[`foot(${String(field.key)})`] ? `foot(${String(field.key)})` : \"foot()\", {\n                  label: field.label,\n                  column: field.key,\n                  field,\n                  isFoot: true\n                }, () => [createTextVNode(toDisplayString(unref(getTableFieldHeadLabel)(field)), 1)])])])]),\n                _: 2\n              }, 1040, [\"class\", \"title\", \"abbr\", \"style\", \"variant\", \"onClick\"]);\n            }), 128))]),\n            _: 3\n          }, 8, [\"variant\", \"class\"])]),\n          _: 3\n        }, 16)) : slots[\"custom-foot\"] ? (openBlock(), createBlock(_sfc_main$5, normalizeProps(mergeProps({\n          key: 1\n        }, footerProps.value)), {\n          default: withCtx(() => [renderSlot(_ctx.$slots, \"custom-foot\", {\n            fields: computedFields.value,\n            items: unref(props).items,\n            columns: computedFieldsTotal.value\n          })]),\n          _: 3\n        }, 16)) : createCommentVNode(\"\", true), slots[\"table-caption\"] || unref(props).caption ? (openBlock(), createElementBlock(\"caption\", _hoisted_3$1, [renderSlot(_ctx.$slots, \"table-caption\", {}, () => [createTextVNode(toDisplayString(unref(props).caption), 1)])])) : createCommentVNode(\"\", true)]),\n        _: 3\n      }, 16);\n    };\n  }\n});\nconst _hoisted_1 = {\n  style: {\n    opacity: 0.4\n  },\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"24\",\n  height: \"24\",\n  fill: \"currentColor\",\n  class: \"bi bi-arrow-up-short\",\n  viewBox: \"0 0 16 16\",\n  \"aria-hidden\": \"\"\n};\nconst _hoisted_2 = {\n  role: \"alert\",\n  \"aria-live\": \"polite\"\n};\nconst _hoisted_3 = {\n  class: \"text-center my-2\"\n};\nconst _sfc_main = /* @__PURE__ */defineComponent({\n  __name: \"BTable\",\n  props: /* @__PURE__ */mergeModels({\n    provider: {\n      default: void 0\n    },\n    noProvider: {\n      default: void 0\n    },\n    noProviderPaging: {\n      type: Boolean,\n      default: false\n    },\n    noProviderSorting: {\n      type: Boolean,\n      default: false\n    },\n    noProviderFiltering: {\n      type: Boolean,\n      default: false\n    },\n    mustSort: {\n      type: [Boolean, Array],\n      default: false\n    },\n    selectable: {\n      type: Boolean,\n      default: false\n    },\n    multisort: {\n      type: Boolean,\n      default: false\n    },\n    stickySelect: {\n      type: Boolean,\n      default: false\n    },\n    selectHead: {\n      type: [Boolean, String],\n      default: true\n    },\n    selectMode: {\n      default: \"multi\"\n    },\n    selectionVariant: {\n      default: \"primary\"\n    },\n    busyLoadingText: {\n      default: \"Loading...\"\n    },\n    perPage: {\n      default: Number.POSITIVE_INFINITY\n    },\n    currentPage: {\n      default: 1\n    },\n    filter: {\n      default: void 0\n    },\n    filterFunction: {\n      type: Function,\n      default: void 0\n    },\n    filterable: {\n      default: void 0\n    },\n    noLocalSorting: {\n      type: Boolean,\n      default: false\n    },\n    noSelectOnClick: {\n      type: Boolean,\n      default: false\n    },\n    noSortableIcon: {\n      type: Boolean,\n      default: false\n    },\n    emptyFilteredText: {\n      default: \"There are no records matching your request\"\n    },\n    emptyText: {\n      default: \"There are no records to show\"\n    },\n    showEmpty: {\n      type: Boolean,\n      default: false\n    },\n    align: {\n      default: void 0\n    },\n    caption: {\n      default: void 0\n    },\n    detailsTdClass: {\n      default: void 0\n    },\n    fieldColumnClass: {\n      type: [Function, String, Object, Array],\n      default: void 0\n    },\n    fields: {\n      default: () => []\n    },\n    footClone: {\n      type: Boolean,\n      default: void 0\n    },\n    footRowVariant: {\n      default: void 0\n    },\n    footVariant: {\n      default: void 0\n    },\n    headRowVariant: {\n      default: void 0\n    },\n    headVariant: {\n      default: void 0\n    },\n    items: {\n      default: () => []\n    },\n    labelStacked: {\n      type: Boolean,\n      default: void 0\n    },\n    modelValue: {\n      default: void 0\n    },\n    primaryKey: {\n      default: void 0\n    },\n    tbodyClass: {\n      default: void 0\n    },\n    tbodyTrAttrs: {},\n    tbodyTrClass: {\n      type: [Function, String, Array, Object],\n      default: void 0\n    },\n    tfootClass: {\n      default: void 0\n    },\n    tfootTrClass: {\n      default: void 0\n    },\n    theadClass: {\n      default: void 0\n    },\n    theadTrClass: {\n      default: void 0\n    },\n    bordered: {\n      type: Boolean,\n      default: void 0\n    },\n    borderless: {\n      type: Boolean,\n      default: void 0\n    },\n    borderVariant: {\n      default: void 0\n    },\n    captionTop: {\n      type: Boolean,\n      default: void 0\n    },\n    dark: {\n      type: Boolean,\n      default: void 0\n    },\n    fixed: {\n      type: Boolean,\n      default: void 0\n    },\n    hover: {\n      type: Boolean,\n      default: void 0\n    },\n    id: {\n      default: void 0\n    },\n    noBorderCollapse: {\n      type: Boolean,\n      default: void 0\n    },\n    outlined: {\n      type: Boolean,\n      default: void 0\n    },\n    responsive: {\n      type: [Boolean, String],\n      default: void 0\n    },\n    small: {\n      type: Boolean,\n      default: void 0\n    },\n    stacked: {\n      type: [Boolean, String],\n      default: void 0\n    },\n    stickyHeader: {\n      type: [Boolean, String, Number],\n      default: void 0\n    },\n    striped: {\n      type: Boolean,\n      default: void 0\n    },\n    stripedColumns: {\n      type: Boolean,\n      default: void 0\n    },\n    variant: {\n      default: void 0\n    },\n    tableAttrs: {}\n  }, {\n    \"sortBy\": {\n      default: void 0\n    },\n    \"sortByModifiers\": {},\n    \"busy\": {\n      type: Boolean,\n      ...{\n        default: false\n      }\n    },\n    \"busyModifiers\": {},\n    \"selectedItems\": {\n      default: () => []\n    },\n    \"selectedItemsModifiers\": {}\n  }),\n  emits: /* @__PURE__ */mergeModels([\"filtered\", \"head-clicked\", \"row-clicked\", \"row-dblclicked\", \"row-contextmenu\", \"row-hovered\", \"row-unhovered\", \"row-middle-clicked\", \"row-selected\", \"row-unselected\", \"sorted\", \"change\"], [\"update:sortBy\", \"update:busy\", \"update:selectedItems\"]),\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    const _props = __props;\n    const props = useDefaults(_props, \"BTable\");\n    const emit = __emit;\n    const slots = useSlots();\n    const dynamicCellSlots = computed(() => Object.keys(slots).filter(key => key.startsWith(\"cell(\")));\n    const dynamicFootSlots = computed(() => Object.keys(slots).filter(key => key.startsWith(\"foot(\")));\n    const sortByModel = useModel(__props, \"sortBy\");\n    const busyModel = useModel(__props, \"busy\");\n    const selectedItemsModel = useModel(__props, \"selectedItems\");\n    const computedId = useId(() => props.id);\n    const selectedItemsToSet = computed({\n      get: () => new Set(selectedItemsModel.value),\n      set: val => {\n        selectedItemsModel.value = [...val];\n      }\n    });\n    watch(selectedItemsToSet, (newValue, oldValue) => {\n      Array.from(oldValue).filter(item => !newValue.has(item)).forEach(item => {\n        emit(\"row-unselected\", item);\n      });\n      Array.from(newValue).filter(item => !oldValue.has(item)).forEach(item => {\n        emit(\"row-selected\", item);\n      });\n    });\n    const selectedItemsSetUtilities = {\n      add: item => {\n        const value = new Set(selectedItemsToSet.value);\n        value.add(item);\n        selectedItemsToSet.value = value;\n      },\n      clear: () => {\n        selectedItemsToSet.value.forEach(item => {\n          selectedItemsSetUtilities.delete(item);\n        });\n      },\n      delete: item => {\n        const value = new Set(selectedItemsToSet.value);\n        if (props.primaryKey) {\n          const pkey = props.primaryKey;\n          selectedItemsModel.value.forEach((v, i) => {\n            const selectedKey = get(v, pkey);\n            const itemKey = get(item, pkey);\n            if (!!selectedKey && !!itemKey && selectedKey === itemKey) {\n              value.delete(selectedItemsModel.value[i]);\n            }\n          });\n        } else {\n          value.delete(item);\n        }\n        selectedItemsToSet.value = value;\n      },\n      set: items => {\n        selectedItemsToSet.value = new Set(items);\n      },\n      has: item => {\n        if (!props.primaryKey) return selectedItemsToSet.value.has(item);\n        const pkey = props.primaryKey;\n        for (const selected of selectedItemsToSet.value) {\n          const selectedKey = get(selected, pkey);\n          const itemKey = get(item, pkey);\n          if (!!selectedKey && !!itemKey && selectedKey === itemKey) return true;\n        }\n        return false;\n      }\n    };\n    const internalItems = ref([]);\n    const perPageNumber = useToNumber(() => props.perPage, {\n      method: \"parseInt\"\n    });\n    const currentPageNumber = useToNumber(() => props.currentPage, {\n      method: \"parseInt\"\n    });\n    const isFilterableTable = computed(() => !!props.filter);\n    const usesProvider = computed(() => props.provider !== void 0);\n    const isSelecting = computed(() => selectedItemsToSet.value.size > 0);\n    const isSortable = computed(() => sortByModel.value !== void 0 || props.fields.some(field => typeof field === \"object\" && field !== null && field.sortable === true));\n    const computedFields = computed(() => props.fields.map(el => {\n      var _a;\n      if (!isTableField(el)) {\n        const label = startCase(el);\n        return {\n          key: el,\n          label,\n          tdAttr: getDataLabelAttr(props, label)\n        };\n      }\n      const value = (_a = sortByModel.value) == null ? void 0 : _a.find(sb => el.key === sb.key);\n      const sortValue = isSortable.value === false ? void 0 : value === void 0 ? \"none\" : value.order === \"desc\" ? \"descending\" : value.order === \"asc\" ? \"ascending\" : \"none\";\n      return {\n        ...el,\n        thAttr: {\n          \"aria-sort\": sortValue,\n          ...el.thAttr\n        }\n      };\n    }));\n    const tableClasses = computed(() => ({\n      \"b-table-busy\": busyModel.value,\n      \"b-table-selectable\": props.selectable,\n      \"user-select-none\": props.selectable && isSelecting.value\n    }));\n    const getBusyRowClasses = computed(() => [props.tbodyTrClass ? typeof props.tbodyTrClass === \"function\" ? props.tbodyTrClass(null, \"table-busy\") : props.tbodyTrClass : null]);\n    const getFieldColumnClasses = field => [{\n      \"b-table-sortable-column\": isSortable.value && field.sortable\n    }];\n    const getRowClasses = (item, type) => [{\n      [`selected table-${props.selectionVariant}`]: props.selectable && !!item && selectedItemsSetUtilities.has(item)\n    }, props.tbodyTrClass ? typeof props.tbodyTrClass === \"function\" ? props.tbodyTrClass(item, type) : props.tbodyTrClass : null];\n    const getFormatter = value => typeof value.sortByFormatted === \"function\" ? value.sortByFormatted : value.formatter;\n    const computedItems = computed(() => {\n      var _a;\n      const sortByItems = (_a = sortByModel.value) == null ? void 0 : _a.filter(el => !!el.order);\n      const mapItem = item => {\n        if (typeof item === \"object\" && item !== null && Object.keys(item).some(key => key.includes(\".\"))) {\n          let newItem = {};\n          for (const key in item) {\n            if (key.includes(\".\")) {\n              newItem = set(newItem, key, item[key]);\n            } else {\n              newItem[key] = item[key];\n            }\n          }\n          return newItem;\n        }\n        return item;\n      };\n      const filterItem = item => {\n        if (!isTableItem(item)) return true;\n        return Object.entries(item).some(([key, val]) => {\n          var _a2, _b, _c;\n          if (val === null || val === void 0 || key[0] === \"_\" || !((_a2 = props.filterable) == null ? void 0 : _a2.includes(key)) && !!((_b = props.filterable) == null ? void 0 : _b.length)) return false;\n          if (props.filterFunction && typeof props.filterFunction === \"function\") {\n            return props.filterFunction(item, props.filter);\n          }\n          const realVal = () => {\n            const filterField = computedFields.value.find(el => {\n              if (isTableField(el)) return el.key === key;\n              return false;\n            });\n            if (isTableField(filterField) && !!filterField.filterByFormatted) {\n              const formatter = getFormatter(filterField);\n              if (formatter) {\n                return String(formatter(val, String(filterField.key), item));\n              }\n            }\n            return typeof val === \"object\" ? JSON.stringify(Object.values(val)) : val.toString();\n          };\n          const itemValue = realVal();\n          return itemValue.toLowerCase().includes(((_c = props.filter) == null ? void 0 : _c.toLowerCase()) ?? \"\");\n        });\n      };\n      const mappedItems = (usesProvider.value ? internalItems.value : props.items).reduce((acc, val) => {\n        const item = mapItem(val);\n        const shouldFilter = isFilterableTable.value && (!usesProvider.value || props.noProviderFiltering);\n        if (!shouldFilter || filterItem(item)) acc.push(item);\n        return acc;\n      }, []);\n      if ((sortByItems == null ? void 0 : sortByItems.length) && (isSortable.value === true && !usesProvider.value && !props.noLocalSorting || isSortable.value === true && usesProvider.value && props.noProviderSorting)) {\n        return mappedItems.sort((a, b) => {\n          for (let i = 0; i < sortByItems.length; i++) {\n            const {\n              key,\n              comparer,\n              order\n            } = sortByItems[i];\n            const getStringValue = ob => {\n              if (!isTableItem(ob)) return String(ob);\n              const sortField = computedFields.value.find(el => {\n                if (isTableField(el)) return el.key === key;\n                return false;\n              });\n              const val = get(ob, key);\n              if (isTableField(sortField) && !!sortField.sortByFormatted) {\n                const formatter = getFormatter(sortField);\n                if (formatter) {\n                  return String(formatItem(ob, String(sortField.key), formatter));\n                }\n              }\n              return typeof val === \"object\" && val !== null ? JSON.stringify(val) : (val == null ? void 0 : val.toString()) ?? \"\";\n            };\n            const comparison = comparer ? comparer(a, b, key) : getStringValue(a).localeCompare(getStringValue(b), void 0, {\n              numeric: true\n            });\n            if (comparison !== 0) {\n              return order === \"asc\" ? comparison : -comparison;\n            }\n          }\n          return 0;\n        });\n      }\n      return mappedItems;\n    });\n    const emptySlotScope = computed(() => ({\n      emptyFilteredText: props.emptyFilteredText,\n      emptyText: props.emptyText,\n      fields: computedFields.value,\n      items: computedItems.value\n    }));\n    const computedDisplayItems = computed(() => {\n      if (Number.isNaN(perPageNumber.value) || usesProvider.value && !props.noProviderPaging) {\n        return computedItems.value;\n      }\n      return computedItems.value.slice((currentPageNumber.value - 1) * (perPageNumber.value || Number.POSITIVE_INFINITY), currentPageNumber.value * (perPageNumber.value || Number.POSITIVE_INFINITY));\n    });\n    watch(computedDisplayItems, v => {\n      emit(\"change\", v);\n    });\n    const handleRowSelection = (row, index, shiftClicked = false, ctrlClicked = false, metaClicked = false) => {\n      if (!props.selectable) return;\n      if (props.selectMode === \"single\" || props.selectMode === \"multi\") {\n        if (shiftClicked || ctrlClicked) return;\n        if (selectedItemsSetUtilities.has(row)) {\n          selectedItemsSetUtilities.delete(row);\n        } else {\n          if (props.selectMode === \"single\") {\n            selectedItemsSetUtilities.set([row]);\n          } else {\n            selectedItemsSetUtilities.add(row);\n          }\n        }\n      } else {\n        if (ctrlClicked || metaClicked) {\n          if (selectedItemsSetUtilities.has(row)) {\n            selectedItemsSetUtilities.delete(row);\n          } else {\n            selectedItemsSetUtilities.add(row);\n          }\n        } else if (shiftClicked) {\n          const lastSelectedItem = [...selectedItemsToSet.value].pop();\n          const lastSelectedIndex = computedItems.value.findIndex(i => i === lastSelectedItem);\n          const selectStartIndex = Math.min(lastSelectedIndex, index);\n          const selectEndIndex = Math.max(lastSelectedIndex, index);\n          const items = computedItems.value.slice(selectStartIndex, selectEndIndex + 1);\n          selectedItemsSetUtilities.set(items);\n        } else {\n          selectedItemsSetUtilities.set([row]);\n        }\n      }\n    };\n    const onRowClick = (row, index, e) => {\n      if (props.noSelectOnClick === false) {\n        handleRowSelection(row, index, e.shiftKey, e.ctrlKey, e.metaKey);\n      }\n      emit(\"row-clicked\", row, index, e);\n    };\n    const handleFieldSorting = field => {\n      var _a, _b;\n      if (!isSortable.value) return;\n      const fieldKey = typeof field === \"object\" && field !== null ? field.key : field;\n      const fieldSortable = typeof field === \"object\" && field !== null ? field.sortable : false;\n      if (!(isSortable.value === true && fieldSortable === true)) return;\n      const resolveOrder = val => {\n        if (val === \"asc\") return \"desc\";\n        if (val === void 0) return \"asc\";\n        if (props.mustSort === true || Array.isArray(props.mustSort) && props.mustSort.includes(fieldKey)) return \"asc\";\n        return void 0;\n      };\n      const index = ((_a = sortByModel.value) == null ? void 0 : _a.findIndex(el => el.key === fieldKey)) ?? -1;\n      const originalValue = (_b = sortByModel.value) == null ? void 0 : _b[index];\n      const updatedValue =\n      // If value is new, we default to ascending\n      // Otherwise we make a temp copy of the value\n      index === -1 || !originalValue ? {\n        key: fieldKey,\n        order: \"asc\"\n      } : {\n        ...originalValue\n      };\n      const handleMultiSort = () => {\n        sortByModel.value = sortByModel.value ?? [];\n        const val = updatedValue;\n        if (index === -1) {\n          sortByModel.value.push(val);\n        } else {\n          val.order = resolveOrder(val.order);\n          sortByModel.value.splice(index, 1, val);\n        }\n        return val;\n      };\n      const handleSingleSort = () => {\n        const val = {\n          ...updatedValue,\n          order: index === -1 ? updatedValue.order : resolveOrder(updatedValue.order)\n        };\n        const tmp = (sortByModel.value || []).map(e => ({\n          ...e,\n          order: void 0\n        }));\n        if (index === -1) {\n          tmp.push(val);\n        } else {\n          tmp[index] = val;\n        }\n        sortByModel.value = tmp;\n        return val;\n      };\n      emit(\"sorted\", props.multisort === true ? handleMultiSort() : handleSingleSort());\n    };\n    const onFieldHeadClick = (fieldKey, field, event, isFooter = false) => {\n      emit(\"head-clicked\", fieldKey, field, event, isFooter);\n      handleFieldSorting(field);\n    };\n    const callItemsProvider = async () => {\n      if (!usesProvider.value || props.provider === void 0 || busyModel.value) return;\n      busyModel.value = true;\n      const response = props.provider({\n        currentPage: currentPageNumber.value,\n        filter: props.filter,\n        sortBy: sortByModel.value,\n        perPage: perPageNumber.value\n      });\n      try {\n        const items = response instanceof Promise ? await response : response;\n        if (items === void 0) return;\n        internalItems.value = items;\n      } finally {\n        busyModel.value = false;\n      }\n    };\n    const providerPropsWatch = async (prop, val, oldVal) => {\n      if (val === oldVal) return;\n      const inNoProvider = key => {\n        var _a;\n        return ((_a = props.noProvider) == null ? void 0 : _a.includes(key)) === true;\n      };\n      const noProvideWhenPaging = (prop === \"currentPage\" || prop === \"perPage\") && (inNoProvider(\"paging\") || props.noProviderPaging === true);\n      const noProvideWhenFiltering = prop === \"filter\" && (inNoProvider(\"filtering\") || props.noProviderFiltering === true);\n      const noProvideWhenSorting = (prop === \"sortBy\" || prop === \"sortDesc\") && (inNoProvider(\"sorting\") || props.noProviderSorting === true);\n      if (noProvideWhenPaging || noProvideWhenFiltering || noProvideWhenSorting) return;\n      if (usesProvider.value === true) {\n        await callItemsProvider();\n      }\n      if (!(prop === \"currentPage\" || prop === \"perPage\")) {\n        emit(\"filtered\", [...computedItems.value]);\n      }\n    };\n    watch(() => props.filter, (filter, oldFilter) => {\n      providerPropsWatch(\"filter\", filter, oldFilter);\n      if (filter === oldFilter || usesProvider.value) return;\n      if (!filter) {\n        emit(\"filtered\", [...computedItems.value]);\n      }\n    });\n    watch(currentPageNumber, (val, oldVal) => {\n      providerPropsWatch(\"currentPage\", val, oldVal);\n    });\n    watch(perPageNumber, (val, oldVal) => {\n      providerPropsWatch(\"perPage\", val, oldVal);\n    });\n    watch(sortByModel, (val, oldVal) => {\n      providerPropsWatch(\"sortBy\", val, oldVal);\n    }, {\n      deep: true\n    });\n    watch(() => props.provider, newValue => {\n      if (newValue === void 0) {\n        internalItems.value = [];\n        return;\n      }\n      callItemsProvider();\n    });\n    onMounted(callItemsProvider);\n    const exposedSelectableUtilities = {\n      clearSelected: () => {\n        if (!props.selectable) return;\n        selectedItemsSetUtilities.clear();\n      },\n      selectAllRows: () => {\n        if (!props.selectable || props.selectMode === \"single\") return;\n        selectedItemsToSet.value = new Set(computedItems.value);\n      },\n      selectRow: index => {\n        if (!props.selectable) return;\n        const item = computedItems.value[index];\n        if (!item || selectedItemsSetUtilities.has(item)) return;\n        if (props.selectMode === \"single\") {\n          selectedItemsSetUtilities.set([item]);\n        } else {\n          selectedItemsSetUtilities.add(item);\n        }\n      },\n      unselectRow: index => {\n        if (!props.selectable) return;\n        const item = computedItems.value[index];\n        if (!item || !selectedItemsSetUtilities.has(item)) return;\n        selectedItemsSetUtilities.delete(item);\n      },\n      isRowSelected: index => {\n        if (!props.selectable) return false;\n        const item = computedItems.value[index];\n        return selectedItemsSetUtilities.has(item);\n      }\n    };\n    const computedLiteProps = computed(() => ({\n      ...pick(props, [...btableLiteProps, ...btableSimpleProps]),\n      tableAttrs: {\n        ariaBusy: busyModel.value\n      },\n      items: computedDisplayItems.value,\n      fields: computedFields.value,\n      tableClass: tableClasses.value,\n      tbodyTrClass: getRowClasses,\n      fieldColumnClass: getFieldColumnClasses,\n      id: computedId.value\n    }));\n    __expose({\n      // The row selection methods are really for compat. Users should probably use the v-model though\n      ...exposedSelectableUtilities,\n      items: computedItems,\n      refresh: callItemsProvider\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createBlock(_sfc_main$1, mergeProps(computedLiteProps.value, {\n        onHeadClicked: onFieldHeadClick,\n        onRowClicked: onRowClick,\n        onRowDblclicked: _cache[0] || (_cache[0] = (row, index, e) => {\n          emit(\"row-dblclicked\", row, index, e);\n        }),\n        onRowContextmenu: _cache[1] || (_cache[1] = (row, index, e) => {\n          emit(\"row-contextmenu\", row, index, e);\n        }),\n        onRowHovered: _cache[2] || (_cache[2] = (row, index, e) => {\n          emit(\"row-hovered\", row, index, e);\n        }),\n        onRowUnhovered: _cache[3] || (_cache[3] = (row, index, e) => {\n          emit(\"row-unhovered\", row, index, e);\n        }),\n        onRowMiddleClicked: _cache[4] || (_cache[4] = (row, index, e) => {\n          emit(\"row-middle-clicked\", row, index, e);\n        })\n      }), createSlots({\n        \"custom-body\": withCtx(scope => [busyModel.value && slots[\"table-busy\"] ? (openBlock(), createBlock(_sfc_main$2, {\n          key: 0,\n          class: normalizeClass([\"b-table-busy-slot\", getBusyRowClasses.value])\n        }, {\n          default: withCtx(() => [createVNode(_sfc_main$6, {\n            colspan: scope.fields.length\n          }, {\n            default: withCtx(() => [renderSlot(_ctx.$slots, \"table-busy\")]),\n            _: 2\n          }, 1032, [\"colspan\"])]),\n          _: 2\n        }, 1032, [\"class\"])) : unref(props).showEmpty === true && computedItems.value.length === 0 ? (openBlock(), createBlock(_sfc_main$2, {\n          key: 1,\n          class: \"b-table-empty-row\"\n        }, {\n          default: withCtx(() => [createVNode(_sfc_main$6, {\n            colspan: computedFields.value.length\n          }, {\n            default: withCtx(() => [createElementVNode(\"div\", _hoisted_2, [createElementVNode(\"div\", _hoisted_3, [isFilterableTable.value ? renderSlot(_ctx.$slots, \"empty-filtered\", normalizeProps(mergeProps({\n              key: 0\n            }, emptySlotScope.value)), () => [createTextVNode(toDisplayString(unref(props).emptyFilteredText), 1)]) : renderSlot(_ctx.$slots, \"empty\", normalizeProps(mergeProps({\n              key: 1\n            }, emptySlotScope.value)), () => [createTextVNode(toDisplayString(unref(props).emptyText), 1)])])])]),\n            _: 3\n          }, 8, [\"colspan\"])]),\n          _: 3\n        })) : createCommentVNode(\"\", true)]),\n        _: 2\n      }, [slots[\"thead-top\"] ? {\n        name: \"thead-top\",\n        fn: withCtx(scope => [renderSlot(_ctx.$slots, \"thead-top\", mergeProps(scope, {\n          clearSelected: exposedSelectableUtilities.clearSelected,\n          selectAllRows: exposedSelectableUtilities.selectAllRows,\n          fields: computedFields.value\n        }))]),\n        key: \"0\"\n      } : void 0, slots[\"thead-sub\"] ? {\n        name: \"thead-sub\",\n        fn: withCtx(scope => [renderSlot(_ctx.$slots, \"thead-sub\", mergeProps(scope, {\n          fields: computedFields.value\n        }))]),\n        key: \"1\"\n      } : void 0, slots[\"top-row\"] ? {\n        name: \"top-row\",\n        fn: withCtx(scope => [renderSlot(_ctx.$slots, \"top-row\", mergeProps(scope, {\n          fields: computedFields.value\n        }))]),\n        key: \"2\"\n      } : void 0, slots[\"row-details\"] ? {\n        name: \"row-details\",\n        fn: withCtx(scope => [renderSlot(_ctx.$slots, \"row-details\", mergeProps(scope, {\n          fields: computedFields.value,\n          selectRow: (index = scope.index) => exposedSelectableUtilities.selectRow(index),\n          unselectRow: (index = scope.index) => exposedSelectableUtilities.unselectRow(index),\n          rowSelected: exposedSelectableUtilities.isRowSelected(scope.index)\n        }))]),\n        key: \"3\"\n      } : void 0, slots[\"bottom-row\"] ? {\n        name: \"bottom-row\",\n        fn: withCtx(scope => [renderSlot(_ctx.$slots, \"bottom-row\", mergeProps(scope, {\n          fields: computedFields.value\n        }))]),\n        key: \"4\"\n      } : void 0, slots[\"custom-foot\"] ? {\n        name: \"custom-foot\",\n        fn: withCtx(scope => [renderSlot(_ctx.$slots, \"custom-foot\", mergeProps(scope, {\n          fields: computedFields.value\n        }))]),\n        key: \"5\"\n      } : void 0, slots[\"table-caption\"] ? {\n        name: \"table-caption\",\n        fn: withCtx(() => [renderSlot(_ctx.$slots, \"table-caption\")]),\n        key: \"6\"\n      } : void 0, renderList(dynamicCellSlots.value, name => {\n        return {\n          name,\n          fn: withCtx(scope => [renderSlot(_ctx.$slots, name, mergeProps(scope, {\n            selectRow: (index = scope.index) => exposedSelectableUtilities.selectRow(index),\n            unselectRow: (index = scope.index) => exposedSelectableUtilities.unselectRow(index),\n            rowSelected: exposedSelectableUtilities.isRowSelected(scope.index)\n          }))])\n        };\n      }), renderList(dynamicFootSlots.value, name => {\n        return {\n          name,\n          fn: withCtx(scope => [renderSlot(_ctx.$slots, name, mergeProps(scope, {\n            selectAllRows: exposedSelectableUtilities.selectAllRows,\n            clearSelected: exposedSelectableUtilities.clearSelected\n          }))])\n        };\n      }), renderList(computedFields.value, field => {\n        return {\n          name: `head(${String(field.key)})`,\n          fn: withCtx(scope => {\n            var _a, _b, _c, _d;\n            return [renderSlot(_ctx.$slots, slots[`head(${String(field.key)})`] ? `head(${String(field.key)})` : \"head()\", mergeProps(scope, {\n              selectAllRows: exposedSelectableUtilities.selectAllRows,\n              clearSelected: exposedSelectableUtilities.clearSelected\n            }), () => [createTextVNode(toDisplayString(unref(getTableFieldHeadLabel)(field)), 1)]), isSortable.value && !!scope.field.sortable && unref(props).noSortableIcon === false ? (openBlock(), createElementBlock(Fragment, {\n              key: 0\n            }, [((_b = (_a = sortByModel.value) == null ? void 0 : _a.find(el => el.key === scope.field.key)) == null ? void 0 : _b.order) === \"asc\" ? renderSlot(_ctx.$slots, slots[`sortAsc(${String(scope.field.key)})`] ? `sortAsc(${String(scope.field.key)})` : \"sortAsc()\", normalizeProps(mergeProps({\n              key: 0\n            }, scope)), () => [_cache[5] || (_cache[5] = createElementVNode(\"svg\", {\n              xmlns: \"http://www.w3.org/2000/svg\",\n              width: \"24\",\n              height: \"24\",\n              fill: \"currentColor\",\n              class: \"bi bi-arrow-up-short\",\n              viewBox: \"0 0 16 16\",\n              \"aria-hidden\": \"\"\n            }, [createElementVNode(\"path\", {\n              \"fill-rule\": \"evenodd\",\n              d: \"M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5z\"\n            })], -1))]) : ((_d = (_c = sortByModel.value) == null ? void 0 : _c.find(el => el.key === scope.field.key)) == null ? void 0 : _d.order) === \"desc\" ? renderSlot(_ctx.$slots, slots[`sortDesc(${String(scope.field.key)})`] ? `sortDesc(${String(scope.field.key)})` : \"sortDesc()\", normalizeProps(mergeProps({\n              key: 1\n            }, scope)), () => [_cache[6] || (_cache[6] = createElementVNode(\"svg\", {\n              xmlns: \"http://www.w3.org/2000/svg\",\n              width: \"24\",\n              height: \"24\",\n              fill: \"currentColor\",\n              class: \"bi bi-arrow-down-short\",\n              viewBox: \"0 0 16 16\",\n              \"aria-hidden\": \"\"\n            }, [createElementVNode(\"path\", {\n              \"fill-rule\": \"evenodd\",\n              d: \"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4z\"\n            })], -1))]) : renderSlot(_ctx.$slots, slots[`sortDefault(${String(scope.field.key)})`] ? `sortDefault(${String(scope.field.key)})` : \"sortDefault()\", normalizeProps(mergeProps({\n              key: 2\n            }, scope)), () => [(openBlock(), createElementBlock(\"svg\", _hoisted_1, _cache[7] || (_cache[7] = [createElementVNode(\"path\", {\n              \"fill-rule\": \"evenodd\",\n              d: \"M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5z\"\n            }, null, -1)])))])], 64)) : createCommentVNode(\"\", true)];\n          })\n        };\n      })]), 1040);\n    };\n  }\n});\nexport { _sfc_main as _, _sfc_main$1 as a, _sfc_main$7 as b, _sfc_main$6 as c, _sfc_main$5 as d, _sfc_main$4 as e, _sfc_main$3 as f, _sfc_main$2 as g };","map":{"version":3,"names":["formatItem","item","fieldKey","formatter","val","get","isTableItem","value","isTableField","_props","__props","props","useDefaults","computedClasses","computed","variant","stickyColumn","scope","colspan","rowspan","getTableFieldHeadLabel","field","titleCase","label","key","btableSimpleProps","Object","freeze","keys","bordered","borderless","borderVariant","captionTop","dark","fixed","hover","id","noBorderCollapse","outlined","responsive","small","stacked","stickyHeader","striped","stripedColumns","tableAttrs","tableClass","btableLiteProps","align","caption","detailsTdClass","fieldColumnClass","fields","footClone","footRowVariant","footVariant","headRowVariant","headVariant","items","labelStacked","modelValue","primaryKey","tbodyClass","tbodyTrAttrs","tbodyTrClass","tfootClass","tfootTrClass","theadClass","theadTrClass","getDataLabelAttr","TABLE_TAG_NAMES","eventFilter","join","filterEvent","event","target","el","disabled","indexOf","tagName","closest","labelFor","getAttribute","input","document","getElementById","querySelector","matches","emit","__emit","slots","useSlots","computedId","useId","generateDetailsItem","_showDetails","detailsMap","ref","WeakMap","watch","forEach","set","deep","immediate","computedTableClasses","computedFields","length","firstItem","Array","isArray","map","k","startCase","tdAttr","_noHeader","f","label2","computedFieldsTotal","showComputedHeaders","every","footerProps","class","itemAttributes","attr","callThAttr","type","String","thAttr","headerClicked","isFooter","toggleRowDetails","tr","prevValue","getFieldColumnClasses","thClass","getFieldRowClasses","tdClass","_a","_cellVariants","_b","handleMiddleClick","itemIndex","button","callTbodyTrAttrs","getRowClasses","generateTableRowId","primaryKeyValue","computedSimpleProps","pick","dynamicCellSlots","filter","startsWith","dynamicFootSlots","sortByModel","useModel","busyModel","selectedItemsModel","selectedItemsToSet","Set","newValue","oldValue","from","has","selectedItemsSetUtilities","add","clear","delete","pkey","v","i","selectedKey","itemKey","selected","internalItems","perPageNumber","useToNumber","perPage","method","currentPageNumber","currentPage","isFilterableTable","usesProvider","provider","isSelecting","size","isSortable","some","sortable","find","sb","sortValue","order","tableClasses","selectable","getBusyRowClasses","selectionVariant","getFormatter","sortByFormatted","computedItems","sortByItems","mapItem","includes","newItem","filterItem","entries","_a2","filterable","filterFunction","realVal","filterField","filterByFormatted","JSON","stringify","values","toString","itemValue","toLowerCase","_c","mappedItems","reduce","acc","shouldFilter","noProviderFiltering","push","noLocalSorting","noProviderSorting","sort","a","b","comparer","getStringValue","ob","sortField","comparison","localeCompare","numeric","emptySlotScope","emptyFilteredText","emptyText","computedDisplayItems","Number","isNaN","noProviderPaging","slice","POSITIVE_INFINITY","handleRowSelection","row","index","shiftClicked","ctrlClicked","metaClicked","selectMode","lastSelectedItem","pop","lastSelectedIndex","findIndex","selectStartIndex","Math","min","selectEndIndex","max","onRowClick","e","noSelectOnClick","shiftKey","ctrlKey","metaKey","handleFieldSorting","fieldSortable","resolveOrder","mustSort","originalValue","updatedValue","handleMultiSort","splice","handleSingleSort","tmp","multisort","onFieldHeadClick","callItemsProvider","response","sortBy","Promise","providerPropsWatch","prop","oldVal","inNoProvider","noProvider","noProvideWhenPaging","noProvideWhenFiltering","noProvideWhenSorting","oldFilter","onMounted","exposedSelectableUtilities","clearSelected","selectAllRows","selectRow","unselectRow","isRowSelected","computedLiteProps","ariaBusy","__expose","refresh"],"sources":["../src/utils/formatItem.ts","../src/types/TableTypes.ts","../src/components/BTable/BTbody.vue","../src/components/BTable/BTd.vue","../src/components/BTable/BTfoot.vue","../src/components/BTable/BTh.vue","../src/components/BTable/BThead.vue","../src/components/BTable/BTr.vue","../src/utils/tableUtils.ts","../src/utils/filterEvent.ts","../src/components/BTable/BTableLite.vue","../src/components/BTable/BTable.vue"],"sourcesContent":["import type {TableFieldFormatter} from '../types/TableTypes'\nimport {get} from './object'\n\nexport const formatItem = <T>(\n  item: T,\n  // Weakly type fieldKey because it can be a nested string, such as 'foo.bar.baz'\n  fieldKey: string,\n  formatter?: TableFieldFormatter<T>\n) => {\n  const val = get(item, fieldKey)\n  return formatter && typeof formatter === 'function' ? formatter(val, fieldKey, item) : val\n}\n","import type {StyleValue} from 'vue'\nimport type {ColorVariant} from './ColorTypes'\nimport type {MaybePromise} from './MaybePromise'\nimport type {LiteralUnion} from './LiteralUnion'\nimport type {AttrsValue, ClassValue} from './AnyValuedAttributes'\n\nexport type TableRowEvent<T> = [item: T, index: number, event: MouseEvent]\n\nexport type TableItem<T = Record<string, unknown>> = T & {\n  _rowVariant?: ColorVariant | null\n  _cellVariants?: Partial<Record<keyof T, ColorVariant>>\n  _showDetails?: boolean\n}\n\nexport const isTableItem = (value: unknown): value is TableItem =>\n  typeof value === 'object' && value !== null\n\n/**\n * `undefined` means it's not sorting this column. It is set to undefined rather than removed from the array because\n * we don't want to make updates that remove the comparer function from the value.\n */\nexport type BTableSortByOrder = 'desc' | 'asc' | undefined\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type BTableSortByComparerFunction<T = any> = (a: T, b: T, key: string) => number\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type BTableSortBy<T = any> = {\n  order: BTableSortByOrder\n  key: string\n  comparer?: BTableSortByComparerFunction<T>\n}\n\nexport type BTableProviderContext<T = unknown> = {\n  sortBy: BTableSortBy<T>[] | undefined\n  filter: string | undefined\n  currentPage: number\n  perPage: number\n}\n\nexport type BTableProvider<T> = (\n  context: Readonly<BTableProviderContext<T>>\n) => MaybePromise<T[] | undefined>\n\nexport type TableFieldFormatter<T> = (value: unknown, key: string, item: T) => string\n\nexport type TableRowType = 'row' | 'row-details' | 'row-top' | 'row-bottom' | 'table-busy'\nexport type TableRowThead = 'top' | 'bottom'\n\nexport type TableStrictClassValue = string | unknown[] | Record<string, boolean>\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type TableField<T = any> = {\n  key: LiteralUnion<keyof T>\n  label?: string\n  headerTitle?: string\n  headerAbbr?: string\n  class?: ClassValue\n  formatter?: TableFieldFormatter<T>\n  sortable?: boolean\n  sortDirection?: string\n  sortByFormatted?: boolean | TableFieldFormatter<T>\n  filterByFormatted?: boolean | TableFieldFormatter<T>\n  tdClass?:\n    | TableStrictClassValue\n    | ((value: unknown, key: string, item: T) => TableStrictClassValue)\n  thClass?: ClassValue\n  thStyle?: StyleValue\n  variant?: ColorVariant | null\n  tdAttr?: AttrsValue | ((value: unknown, key: string, item: T) => AttrsValue)\n  thAttr?:\n    | AttrsValue\n    | ((value: unknown, key: string, item: T | null, type: TableRowThead) => AttrsValue)\n  isRowHeader?: boolean\n  stickyColumn?: boolean\n}\n\nexport type TableFieldRaw<T = unknown> = T extends object\n  ? LiteralUnion<keyof T> | TableField<T>\n  : string | TableField\n\nexport const isTableField = <T>(value: unknown): value is TableField<T> =>\n  typeof value === 'object' && value !== null && 'key' in value\n\nexport const isTableFieldRaw = <T>(value: unknown): value is TableFieldRaw<T> =>\n  typeof value === 'string' || isTableField(value)\n\nexport type NoProviderTypes = 'paging' | 'sorting' | 'filtering'\n","<template>\n  <tbody :class=\"computedClasses\">\n    <slot />\n  </tbody>\n</template>\n\n<script setup lang=\"ts\">\nimport {useDefaults} from '../../composables/useDefaults'\nimport type {BTbodyProps} from '../../types/ComponentProps'\nimport {computed} from 'vue'\n\nconst _props = withDefaults(defineProps<BTbodyProps>(), {\n  variant: null,\n})\nconst props = useDefaults(_props, 'BTbody')\n\ndefineSlots<{\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  default?: (props: Record<string, never>) => any\n}>()\n\nconst computedClasses = computed(() => ({\n  [`thead-${props.variant}`]: props.variant !== null,\n}))\n</script>\n","<template>\n  <td\n    :scope=\"scope\"\n    :class=\"computedClasses\"\n    :colspan=\"props.colspan\"\n    :rowspan=\"props.rowspan\"\n    :data-label=\"props.stackedHeading\"\n  >\n    <div v-if=\"props.stackedHeading\">\n      <slot />\n    </div>\n    <slot v-else />\n  </td>\n</template>\n\n<script setup lang=\"ts\">\nimport {useDefaults} from '../../composables/useDefaults'\nimport type {BTdProps} from '../../types/ComponentProps'\nimport {computed} from 'vue'\n\nconst _props = withDefaults(defineProps<BTdProps>(), {\n  colspan: undefined,\n  rowspan: undefined,\n  stackedHeading: undefined,\n  stickyColumn: false,\n  variant: null,\n})\nconst props = useDefaults(_props, 'BTd')\n\ndefineSlots<{\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  default?: (props: Record<string, never>) => any\n}>()\n\nconst computedClasses = computed(() => ({\n  [`table-${props.variant}`]: props.variant !== null,\n  'b-table-sticky-column': props.stickyColumn,\n  'table-b-table-default': props.stickyColumn && props.variant === null,\n}))\n\nconst scope = computed(() => (props.colspan ? 'colspan' : props.rowspan ? 'rowspan' : 'col'))\n</script>\n","<template>\n  <tfoot :class=\"computedClasses\">\n    <slot />\n  </tfoot>\n</template>\n\n<script setup lang=\"ts\">\nimport {useDefaults} from '../../composables/useDefaults'\nimport type {BTfootProps} from '../../types/ComponentProps'\nimport {computed} from 'vue'\n\nconst _props = withDefaults(defineProps<BTfootProps>(), {\n  variant: null,\n})\nconst props = useDefaults(_props, 'BTfoot')\n\ndefineSlots<{\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  default?: (props: Record<string, never>) => any\n}>()\n\nconst computedClasses = computed(() => ({\n  [`table-${props.variant}`]: props.variant !== null,\n}))\n</script>\n","<template>\n  <th\n    :scope=\"scope\"\n    :class=\"computedClasses\"\n    :colspan=\"props.colspan\"\n    :rowspan=\"props.rowspan\"\n    :data-label=\"props.stackedHeading\"\n  >\n    <div v-if=\"props.stackedHeading !== undefined\">\n      <slot />\n    </div>\n    <slot v-else />\n  </th>\n</template>\n\n<script setup lang=\"ts\">\nimport {useDefaults} from '../../composables/useDefaults'\nimport type {BThProps} from '../../types/ComponentProps'\nimport {computed} from 'vue'\n\nconst _props = withDefaults(defineProps<BThProps>(), {\n  colspan: undefined,\n  rowspan: undefined,\n  stackedHeading: undefined,\n  stickyColumn: false,\n  variant: null,\n})\nconst props = useDefaults(_props, 'BTh')\n\ndefineSlots<{\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  default?: (props: Record<string, never>) => any\n}>()\n\nconst computedClasses = computed(() => ({\n  [`table-${props.variant}`]: props.variant !== null,\n  'b-table-sticky-column': props.stickyColumn,\n  'table-b-table-default': props.stickyColumn && props.variant === null,\n}))\n\nconst scope = computed(() => (props.colspan ? 'colspan' : props.rowspan ? 'rowspan' : 'col'))\n</script>\n","<template>\n  <thead :class=\"computedClasses\">\n    <slot />\n  </thead>\n</template>\n\n<script setup lang=\"ts\">\nimport {useDefaults} from '../../composables/useDefaults'\nimport type {BTheadProps} from '../../types/ComponentProps'\nimport {computed} from 'vue'\n\nconst _props = withDefaults(defineProps<BTheadProps>(), {\n  variant: null,\n})\nconst props = useDefaults(_props, 'BThead')\n\ndefineSlots<{\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  default?: (props: Record<string, never>) => any\n}>()\n\nconst computedClasses = computed(() => ({\n  [`table-${props.variant}`]: props.variant !== null,\n}))\n</script>\n","<template>\n  <tr :class=\"computedClasses\">\n    <slot />\n  </tr>\n</template>\n\n<script setup lang=\"ts\">\nimport {useDefaults} from '../../composables/useDefaults'\nimport type {BTrProps} from '../../types/ComponentProps'\nimport {computed} from 'vue'\n\nconst _props = withDefaults(defineProps<BTrProps>(), {\n  variant: null,\n})\nconst props = useDefaults(_props, 'BTr')\n\ndefineSlots<{\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  default?: (props: Record<string, never>) => any\n}>()\n\nconst computedClasses = computed(() => ({\n  [`table-${props.variant}`]: props.variant !== null,\n}))\n</script>\n","import {titleCase} from './stringUtils'\nimport type {TableFieldRaw} from '../types/TableTypes'\nimport type {Breakpoint, BTableLiteProps, BTableSimpleProps} from '../types'\n\nexport const getTableFieldHeadLabel = (field: Readonly<TableFieldRaw<unknown>>) =>\n  typeof field === 'string'\n    ? titleCase(field)\n    : field.label !== undefined\n      ? field.label\n      : typeof field.key === 'string'\n        ? titleCase(field.key)\n        : field.key\n\nexport const btableSimpleProps = Object.freeze(\n  Object.keys({\n    bordered: 0,\n    borderless: 0,\n    borderVariant: 0,\n    captionTop: 0,\n    dark: 0,\n    fixed: 0,\n    hover: 0,\n    id: 0,\n    noBorderCollapse: 0,\n    outlined: 0,\n    responsive: 0,\n    small: 0,\n    stacked: 0,\n    stickyHeader: 0,\n    striped: 0,\n    stripedColumns: 0,\n    variant: 0,\n    tableAttrs: 0,\n    tableClass: 0,\n  } satisfies Record<keyof BTableSimpleProps, 0>)\n) as readonly (keyof BTableSimpleProps)[]\n\nexport const btableLiteProps = Object.freeze(\n  Object.keys({\n    align: 0,\n    caption: 0,\n    detailsTdClass: 0,\n    fieldColumnClass: 0,\n    fields: 0,\n    footClone: 0,\n    footRowVariant: 0,\n    footVariant: 0,\n    headRowVariant: 0,\n    headVariant: 0,\n    items: 0,\n    labelStacked: 0,\n    modelValue: 0,\n    primaryKey: 0,\n    tbodyClass: 0,\n    tbodyTrAttrs: 0,\n    tbodyTrClass: 0,\n    tfootClass: 0,\n    tfootTrClass: 0,\n    theadClass: 0,\n    theadTrClass: 0,\n  } satisfies Record<keyof Omit<BTableLiteProps<unknown>, keyof BTableSimpleProps>, 0>)\n) as readonly (keyof Omit<BTableLiteProps<unknown>, keyof BTableSimpleProps>)[]\n\nexport const getDataLabelAttr = (\n  props: {stacked: boolean | Breakpoint | undefined; labelStacked: boolean | undefined},\n  label: string\n) => (props.stacked && props.labelStacked !== true ? {'data-label': label} : undefined)\n","const TABLE_TAG_NAMES = ['TD', 'TH', 'TR']\n\n// Filter CSS selector for click/dblclick/etc. events\n// If any of these selectors match the clicked element, we ignore the event\nconst eventFilter = [\n  'a',\n  'a *', // Include content inside links\n  'button',\n  'button *', // Include content inside buttons\n  'input:not(.disabled):not([disabled])',\n  'select:not(.disabled):not([disabled])',\n  'textarea:not(.disabled):not([disabled])',\n  '[role=\"link\"]',\n  '[role=\"link\"] *',\n  '[role=\"button\"]',\n  '[role=\"button\"] *',\n  '[tabindex]:not(.disabled):not([disabled])',\n].join(',')\n\n// Returns `true` if we should ignore the click/double-click/keypress event\n// Avoids having the user need to use `@click.stop` on the form control\nexport const filterEvent = (event: Readonly<Event>) => {\n  // Exit early when we don't have a target element\n  if (!event || !event.target) {\n    return false\n  }\n  const el = event.target as HTMLElement\n  // Exit early when element is disabled or a table element\n  if (('disabled' in el && el.disabled) || TABLE_TAG_NAMES.indexOf(el.tagName) !== -1) {\n    return false\n  }\n  // Ignore the click when it was inside a dropdown menu\n  if (el.closest('.dropdown-menu')) return true\n\n  const label = el.tagName === 'LABEL' ? el : el.closest('label')\n  // If the label's form control is not disabled then we don't propagate event\n  // Modern browsers have `label.control` that references the associated input, but IE 11\n  // does not have this property on the label element, so we resort to DOM lookups\n  if (label) {\n    const labelFor = label.getAttribute('for')\n    const input = labelFor\n      ? document.getElementById(labelFor)\n      : label.querySelector('input, select, textarea')\n    if (input && !(input as HTMLInputElement).disabled) {\n      return true\n    }\n  }\n  // Otherwise check if the event target matches one of the selectors in the\n  // event filter (i.e. anchors, non disabled inputs, etc.)\n  // Return `true` if we should ignore the event\n  return el.matches(eventFilter)\n}\n","<template>\n  <BTableSimple v-bind=\"computedSimpleProps\">\n    <BThead v-show=\"showComputedHeaders\" :variant=\"props.headVariant\" :class=\"props.theadClass\">\n      <slot name=\"thead-top\" :columns=\"computedFieldsTotal\" :fields=\"computedFields\" />\n      <BTr :variant=\"props.headRowVariant\" :class=\"props.theadTrClass\">\n        <BTh\n          v-for=\"field in computedFields\"\n          :key=\"field.key\"\n          scope=\"col\"\n          :class=\"getFieldColumnClasses(field)\"\n          :title=\"field.headerTitle\"\n          :variant=\"field.variant\"\n          :abbr=\"field.headerAbbr\"\n          :style=\"field.thStyle\"\n          v-bind=\"callThAttr(null, field, 'top')\"\n          @click=\"headerClicked(field, $event)\"\n        >\n          <!-- eslint-disable prettier/prettier -->\n          <slot\n            :name=\"\n              slots[`head(${String(field.key)})`]\n                ? (`head(${String(field.key)})` as 'head()')\n                : 'head()'\n            \"\n            :label=\"field.label\"\n            :column=\"field.key as LiteralUnion<keyof Items>\"\n            :field\n            :is-foot=\"false\"\n          >\n            <!-- eslint-enable prettier/prettier -->\n            {{ getTableFieldHeadLabel(field) }}\n          </slot>\n        </BTh>\n      </BTr>\n      <BTr v-if=\"slots['thead-sub']\">\n        <BTd\n          v-for=\"field in computedFields\"\n          :key=\"field.key\"\n          scope=\"col\"\n          :variant=\"field.variant\"\n          :class=\"[field.class, field.thClass]\"\n        >\n          <slot name=\"thead-sub\" :items=\"props.items\" :fields=\"computedFields\" :field>\n            {{ field.label }}\n          </slot>\n        </BTd>\n      </BTr>\n    </BThead>\n    <BTbody :class=\"props.tbodyClass\">\n      <slot\n        name=\"custom-body\"\n        :fields=\"computedFields\"\n        :items=\"props.items\"\n        :columns=\"computedFieldsTotal\"\n      >\n        <BTr\n          v-if=\"!props.stacked && slots['top-row']\"\n          :class=\"getRowClasses(null, 'row-top')\"\n          v-bind=\"callTbodyTrAttrs(null, 'row-top')\"\n        >\n          <slot name=\"top-row\" :columns=\"computedFieldsTotal\" :fields=\"computedFields\" />\n        </BTr>\n\n        <template\n          v-for=\"(item, itemIndex) in props.items\"\n          :key=\"\n            props.primaryKey && get(item, props.primaryKey)\n              ? get(item, props.primaryKey)\n              : itemIndex\n          \"\n        >\n          <BTr\n            :id=\"\n              props.primaryKey && get(item, props.primaryKey)\n                ? generateTableRowId(get(item, props.primaryKey))\n                : undefined\n            \"\n            :class=\"getRowClasses(item, 'row')\"\n            :variant=\"isTableItem(item) ? item._rowVariant : undefined\"\n            v-bind=\"callTbodyTrAttrs(item, 'row')\"\n            @click=\"!filterEvent($event) && emit('row-clicked', item, itemIndex, $event)\"\n            @dblclick=\"!filterEvent($event) && emit('row-dblclicked', item, itemIndex, $event)\"\n            @contextmenu=\"!filterEvent($event) && emit('row-contextmenu', item, itemIndex, $event)\"\n            @mouseenter=\"!filterEvent($event) && emit('row-hovered', item, itemIndex, $event)\"\n            @mouseleave=\"!filterEvent($event) && emit('row-unhovered', item, itemIndex, $event)\"\n            @mousedown=\"handleMiddleClick(item, itemIndex, $event)\"\n          >\n            <BTd\n              v-for=\"field in computedFields\"\n              :key=\"field.key\"\n              :variant=\"\n                (isTableItem(item) ? item._cellVariants?.[field.key as string] : false)\n                  ? null\n                  : field.variant\n              \"\n              :class=\"getFieldRowClasses(field, item)\"\n              v-bind=\"itemAttributes(item, String(field.key), field.tdAttr)\"\n            >\n              <label v-if=\"props.stacked && props.labelStacked\" class=\"b-table-stacked-label\">\n                {{ getTableFieldHeadLabel(field) }}\n              </label>\n              <slot\n                :name=\"\n                  slots[`cell(${String(field.key)})`]\n                    ? (`cell(${String(field.key)})` as 'cell()')\n                    : 'cell()'\n                \"\n                :value=\"formatItem(item, String(field.key), field.formatter)\"\n                :unformatted=\"get(item, String(field.key))\"\n                :index=\"itemIndex\"\n                :item=\"item\"\n                :field=\"field\"\n                :items=\"items\"\n                :toggle-details=\"() => toggleRowDetails(item)\"\n                :details-showing=\"isTableItem(item) ? (detailsMap.get(item) ?? false) : false\"\n              >\n                <template v-if=\"!slots[`cell(${String(field.key)})`] && !slots['cell()']\">\n                  {{ formatItem(item, String(field.key), field.formatter) }}\n                </template>\n              </slot>\n            </BTd>\n          </BTr>\n\n          <template\n            v-if=\"isTableItem(item) && detailsMap.get(item) === true && slots['row-details']\"\n          >\n            <BTr aria-hidden=\"true\" role=\"presentation\" class=\"d-none\" />\n            <BTr\n              :class=\"getRowClasses(item, 'row-details')\"\n              :variant=\"item._rowVariant\"\n              v-bind=\"callTbodyTrAttrs(item, 'row-details')\"\n            >\n              <BTd :colspan=\"computedFieldsTotal\" :class=\"detailsTdClass\">\n                <slot\n                  name=\"row-details\"\n                  :item=\"item\"\n                  :toggle-details=\"() => toggleRowDetails(item)\"\n                  :fields=\"computedFields\"\n                  :index=\"itemIndex\"\n                />\n              </BTd>\n            </BTr>\n          </template>\n        </template>\n        <!-- This class is for specific targetting of this slot element -->\n        <BTr\n          v-if=\"!props.stacked && slots['bottom-row']\"\n          class=\"bottom-row\"\n          :class=\"getRowClasses(null, 'row-bottom')\"\n          v-bind=\"callTbodyTrAttrs(null, 'row-bottom')\"\n        >\n          <slot name=\"bottom-row\" :columns=\"computedFieldsTotal\" :fields=\"computedFields\" />\n        </BTr>\n      </slot>\n    </BTbody>\n    <BTfoot v-if=\"props.footClone\" v-bind=\"footerProps\">\n      <BTr :variant=\"props.footRowVariant\" :class=\"props.tfootTrClass\">\n        <BTh\n          v-for=\"field in computedFields\"\n          :key=\"field.key\"\n          scope=\"col\"\n          :class=\"getFieldColumnClasses(field)\"\n          :title=\"field.headerTitle\"\n          :abbr=\"field.headerAbbr\"\n          :style=\"field.thStyle\"\n          :variant=\"field.variant\"\n          v-bind=\"callThAttr(null, field, 'bottom')\"\n          @click=\"headerClicked(field, $event, true)\"\n        >\n          <div class=\"d-inline-flex flex-nowrap align-items-center gap-1\">\n            <div>\n              <!-- eslint-disable prettier/prettier -->\n              <slot\n                :name=\"\n                  slots[`foot(${String(field.key)})`]\n                    ? (`foot(${String(field.key)})` as 'foot()')\n                    : 'foot()'\n                \"\n                :label=\"field.label\"\n                :column=\"field.key as LiteralUnion<keyof Items>\"\n                :field=\"field\"\n                :is-foot=\"true\"\n              >\n                <!-- eslint-enable prettier/prettier -->\n                {{ getTableFieldHeadLabel(field) }}\n              </slot>\n            </div>\n          </div>\n        </BTh>\n      </BTr>\n    </BTfoot>\n    <BTfoot v-else-if=\"slots['custom-foot']\" v-bind=\"footerProps\">\n      <slot\n        name=\"custom-foot\"\n        :fields=\"computedFields\"\n        :items=\"props.items\"\n        :columns=\"computedFieldsTotal\"\n      />\n    </BTfoot>\n    <caption v-if=\"slots['table-caption'] || props.caption\">\n      <slot name=\"table-caption\">\n        {{ props.caption }}\n      </slot>\n    </caption>\n  </BTableSimple>\n</template>\n\n<script setup lang=\"ts\" generic=\"Items\">\nimport {computed, ref, watch} from 'vue'\nimport type {BTableLiteProps} from '../../types/ComponentProps'\nimport {\n  isTableField,\n  isTableItem,\n  type TableField,\n  type TableItem,\n  type TableRowEvent,\n  type TableRowThead,\n  type TableRowType,\n} from '../../types/TableTypes'\nimport BTableSimple from './BTableSimple.vue'\nimport BTbody from './BTbody.vue'\nimport BTd from './BTd.vue'\nimport BTfoot from './BTfoot.vue'\nimport BTh from './BTh.vue'\nimport BThead from './BThead.vue'\nimport BTr from './BTr.vue'\nimport {useDefaults} from '../../composables/useDefaults'\nimport {get, pick} from '../../utils/object'\nimport {btableSimpleProps, getDataLabelAttr, getTableFieldHeadLabel} from '../../utils/tableUtils'\nimport {formatItem} from '../../utils/formatItem'\nimport {filterEvent} from '../../utils/filterEvent'\nimport {startCase} from '../../utils/stringUtils'\nimport type {LiteralUnion} from '../../types/LiteralUnion'\nimport {useId} from '../../composables/useId'\n\nconst _props = withDefaults(defineProps<BTableLiteProps<Items>>(), {\n  caption: undefined,\n  align: undefined,\n  fields: () => [],\n  footClone: false,\n  items: () => [],\n  labelStacked: false,\n  fieldColumnClass: undefined,\n  tbodyTrClass: undefined,\n  detailsTdClass: undefined,\n  headVariant: undefined,\n  headRowVariant: undefined,\n  footRowVariant: undefined,\n  footVariant: undefined,\n  modelValue: undefined,\n  primaryKey: undefined,\n  tbodyClass: undefined,\n  tbodyTrAttrs: undefined,\n  tfootClass: undefined,\n  tfootTrClass: undefined,\n  theadClass: undefined,\n  theadTrClass: undefined,\n  // BTableSimpleProps props\n  borderVariant: undefined,\n  tableClass: undefined,\n  variant: undefined,\n  bordered: undefined,\n  borderless: undefined,\n  captionTop: undefined,\n  dark: undefined,\n  hover: undefined,\n  id: undefined,\n  noBorderCollapse: undefined,\n  outlined: undefined,\n  fixed: undefined,\n  responsive: undefined,\n  stacked: undefined,\n  striped: undefined,\n  stripedColumns: undefined,\n  small: undefined,\n  stickyHeader: undefined,\n  // End BTableSimpleProps props\n})\nconst props = useDefaults(_props, 'BTableLite')\n\nconst emit = defineEmits<{\n  'head-clicked': [\n    key: string,\n    field: (typeof computedFields.value)[0],\n    event: MouseEvent,\n    isFooter: boolean,\n  ]\n  'row-clicked': TableRowEvent<Items>\n  'row-dblclicked': TableRowEvent<Items>\n  'row-contextmenu': TableRowEvent<Items>\n  'row-hovered': TableRowEvent<Items>\n  'row-unhovered': TableRowEvent<Items>\n  'row-middle-clicked': TableRowEvent<Items>\n}>()\n\nconst slots = defineSlots<{\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  'thead-top'?: (props: {columns: number; fields: typeof computedFields.value}) => any\n  [key: `head(${string})`]: (props: {\n    label: string | undefined\n    column: LiteralUnion<keyof Items>\n    field: (typeof computedFields.value)[0]\n    isFoot: false\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  }) => any\n  'thead-sub'?: (\n    props: {\n      items: readonly Items[]\n      fields: typeof computedFields.value\n      field: (typeof computedFields.value)[0]\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  ) => any\n  'custom-body'?: (props: {\n    fields: typeof computedFields.value\n    items: readonly Items[]\n    columns: number\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  }) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  'top-row'?: (props: {columns: number; fields: typeof computedFields.value}) => any\n  [key: `cell(${string})`]: (props: {\n    value: unknown\n    unformatted: unknown\n    index: number\n    item: Items\n    field: (typeof computedFields.value)[0]\n    items: readonly Items[]\n    toggleDetails: () => void\n    detailsShowing: boolean\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  }) => any\n  'row-details'?: (props: {\n    item: Items\n    toggleDetails: () => void\n    fields: typeof computedFields.value\n    index: number\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  }) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  'bottom-row'?: (props: {columns: number; fields: typeof computedFields.value}) => any\n  [key: `foot(${string})`]: (props: {\n    label: string | undefined\n    column: LiteralUnion<keyof Items>\n    field: (typeof computedFields.value)[0]\n    isFoot: true\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  }) => any\n  'custom-foot'?: (props: {\n    fields: typeof computedFields.value\n    items: readonly Items[]\n    columns: number\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  }) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  'table-caption'?: (props: Record<string, never>) => any\n}>()\n\nconst computedId = useId(() => props.id)\n\nconst generateDetailsItem = (item: TableItem): [object, boolean | undefined] => [\n  item,\n  item._showDetails,\n]\nconst detailsMap = ref(new WeakMap<object, boolean | undefined>())\nwatch(\n  () => props.items,\n  (items) => {\n    items.forEach((item) => {\n      if (!isTableItem(item)) return\n      detailsMap.value.set(...generateDetailsItem(item))\n    })\n  },\n  {deep: true, immediate: true}\n)\n\nconst computedTableClasses = computed(() => [\n  props.tableClass,\n  {\n    [`align-${props.align}`]: props.align !== undefined,\n  },\n])\n\nconst computedFields = computed<(TableField<Items> & {_noHeader?: true})[]>(() => {\n  if (!props.fields.length && props.items.length) {\n    const [firstItem] = props.items\n    if (firstItem && (isTableItem(firstItem) || Array.isArray(firstItem))) {\n      return Object.keys(firstItem).map((k) => {\n        const label = startCase(k)\n        return {\n          key: k,\n          label,\n          tdAttr: getDataLabelAttr(props, label),\n        }\n      })\n    }\n    // The items are primitives, so we just return a single empty field\n    // No header will be shown, as we don't know what to show\n    return [{key: '', _noHeader: true}]\n  }\n\n  return props.fields.map((f) => {\n    if (isTableField(f)) {\n      const label = f.label ?? startCase(f.key as string)\n      return {\n        ...(f as TableField<Items>),\n        tdAttr: {...getDataLabelAttr(props, label), ...f.tdAttr},\n      }\n    }\n    const label = startCase(f as string)\n    return {\n      key: f as string,\n      label,\n      tdAttr: getDataLabelAttr(props, label),\n    }\n  })\n})\nconst computedFieldsTotal = computed(() => computedFields.value.length)\nconst showComputedHeaders = computed(() => {\n  // We only hide the header if all fields have _noHeader set to true. Which would be our doing\n  // This usually happens under a circumstance of displaying an array of primitives\n  // Under any other circumstance, I'm not sure how this would apply\n  if (computedFieldsTotal.value > 0 && computedFields.value.every((el) => el._noHeader === true))\n    return false\n  return true\n})\n\nconst footerProps = computed(() => ({\n  variant: props.footVariant,\n  class: props.tfootClass,\n}))\n\nconst itemAttributes = (item: Items, fieldKey: string, attr?: unknown) => {\n  const val = get(item, fieldKey)\n  return attr && typeof attr === 'function' ? attr(val, fieldKey, item) : attr\n}\n\nconst callThAttr = (item: Items | null, field: TableField<Items>, type: TableRowThead) => {\n  const fieldKey = String(field.key)\n  const val = get(item, fieldKey)\n  return field.thAttr && typeof field.thAttr === 'function'\n    ? field.thAttr(val, fieldKey, item, type)\n    : field.thAttr\n}\n\nconst headerClicked = (field: TableField<Items>, event: Readonly<MouseEvent>, isFooter = false) => {\n  emit('head-clicked', field.key as string, field, event, isFooter)\n}\n\nconst toggleRowDetails = (tr: Items) => {\n  if (isTableItem(tr)) {\n    const prevValue = detailsMap.value.get(tr)\n    detailsMap.value.set(tr, !prevValue)\n    tr._showDetails = !prevValue\n  }\n}\n\nconst getFieldColumnClasses = (field: TableField) => [\n  field.class,\n  field.thClass,\n  {\n    'b-table-sticky-column': field.stickyColumn,\n  },\n  props.fieldColumnClass\n    ? typeof props.fieldColumnClass === 'function'\n      ? props.fieldColumnClass(field)\n      : props.fieldColumnClass\n    : null,\n]\n\nconst getFieldRowClasses = (field: Readonly<TableField>, tr: Items) => {\n  const val = get(tr, String(field.key))\n  return [\n    field.class,\n    typeof field.tdClass === 'function' ? field.tdClass(val, String(field.key), tr) : field.tdClass,\n    (isTableItem(tr) ? tr._cellVariants?.[field.key as string] : false)\n      ? `table-${(tr as TableItem)._cellVariants?.[field.key as string]}`\n      : null,\n    {\n      'b-table-sticky-column': field.stickyColumn,\n    },\n  ]\n}\n\nconst handleMiddleClick = (item: Items, itemIndex: number, event: MouseEvent) => {\n  if (event.button === 1 && !filterEvent(event)) {\n    emit('row-middle-clicked', item, itemIndex, event)\n  }\n}\nconst callTbodyTrAttrs = (item: Items | null, type: TableRowType) =>\n  props.tbodyTrAttrs\n    ? typeof props.tbodyTrAttrs === 'function'\n      ? props.tbodyTrAttrs(item, type)\n      : props.tbodyTrAttrs\n    : null\n\nconst getRowClasses = (item: Items | null, type: TableRowType) =>\n  props.tbodyTrClass\n    ? typeof props.tbodyTrClass === 'function'\n      ? props.tbodyTrClass(item, type)\n      : props.tbodyTrClass\n    : null\n\nconst generateTableRowId = (primaryKeyValue: string) =>\n  `${computedId.value}__row_${primaryKeyValue}`\n\nconst computedSimpleProps = computed(() => ({\n  ...pick(props, btableSimpleProps),\n  tableClass: computedTableClasses.value,\n  id: computedId.value,\n}))\n</script>\n","<template>\n  <!-- eslint-disable prettier/prettier -->\n  <BTableLite\n    v-bind=\"computedLiteProps\"\n    @head-clicked=\"onFieldHeadClick\"\n    @row-clicked=\"onRowClick\"\n    @row-dblclicked=\"\n      (row: Items, index: number, e: MouseEvent) => {\n        emit('row-dblclicked', row, index, e)\n      }\n    \"\n    @row-contextmenu=\"\n      (row: Items, index: number, e: MouseEvent) => {\n        emit('row-contextmenu', row, index, e)\n      }\n    \"\n    @row-hovered=\"\n      (row: Items, index: number, e: MouseEvent) => {\n        emit('row-hovered', row, index, e)\n      }\n    \"\n    @row-unhovered=\"\n      (row: Items, index: number, e: MouseEvent) => {\n        emit('row-unhovered', row, index, e)\n      }\n    \"\n    @row-middle-clicked=\"\n      (row: Items, index: number, e: MouseEvent) => {\n        emit('row-middle-clicked', row, index, e)\n      }\n    \"\n  >\n    <!-- eslint-enable prettier/prettier -->\n    <template v-if=\"slots['thead-top']\" #thead-top=\"scope\">\n      <slot\n        name=\"thead-top\"\n        v-bind=\"scope\"\n        :clear-selected=\"exposedSelectableUtilities.clearSelected\"\n        :select-all-rows=\"exposedSelectableUtilities.selectAllRows\"\n        :fields=\"computedFields\"\n      />\n    </template>\n    <template v-if=\"slots['thead-sub']\" #thead-sub=\"scope\">\n      <slot name=\"thead-sub\" v-bind=\"scope\" :fields=\"computedFields\" />\n    </template>\n    <template v-if=\"slots['top-row']\" #top-row=\"scope\">\n      <slot name=\"top-row\" v-bind=\"scope\" :fields=\"computedFields\" />\n    </template>\n    <template v-if=\"slots['row-details']\" #row-details=\"scope\">\n      <slot\n        name=\"row-details\"\n        v-bind=\"scope\"\n        :fields=\"computedFields\"\n        :select-row=\"(index = scope.index) => exposedSelectableUtilities.selectRow(index)\"\n        :unselect-row=\"(index = scope.index) => exposedSelectableUtilities.unselectRow(index)\"\n        :row-selected=\"exposedSelectableUtilities.isRowSelected(scope.index)\"\n      />\n    </template>\n    <template v-if=\"slots['bottom-row']\" #bottom-row=\"scope\">\n      <slot name=\"bottom-row\" v-bind=\"scope\" :fields=\"computedFields\" />\n    </template>\n    <template v-if=\"slots['custom-foot']\" #custom-foot=\"scope\">\n      <slot name=\"custom-foot\" v-bind=\"scope\" :fields=\"computedFields\" />\n    </template>\n    <template v-if=\"slots['table-caption']\" #table-caption>\n      <slot name=\"table-caption\" />\n    </template>\n    <template v-for=\"name in dynamicCellSlots\" #[name]=\"scope\">\n      <slot\n        :name\n        v-bind=\"scope\"\n        :select-row=\"(index = scope.index) => exposedSelectableUtilities.selectRow(index)\"\n        :unselect-row=\"(index = scope.index) => exposedSelectableUtilities.unselectRow(index)\"\n        :row-selected=\"exposedSelectableUtilities.isRowSelected(scope.index)\"\n      />\n    </template>\n    <template v-for=\"name in dynamicFootSlots\" #[name]=\"scope\">\n      <slot\n        :name\n        v-bind=\"scope\"\n        :select-all-rows=\"exposedSelectableUtilities.selectAllRows\"\n        :clear-selected=\"exposedSelectableUtilities.clearSelected\"\n      />\n    </template>\n\n    <template\n      v-for=\"field in computedFields\"\n      :key=\"field.key\"\n      #[`head(${String(field.key)})`]=\"scope\"\n    >\n      <slot\n        :name=\"\n          slots[`head(${String(field.key)})`]\n            ? (`head(${String(field.key)})` as 'head()')\n            : 'head()'\n        \"\n        v-bind=\"scope\"\n        :select-all-rows=\"exposedSelectableUtilities.selectAllRows\"\n        :clear-selected=\"exposedSelectableUtilities.clearSelected\"\n      >\n        {{ getTableFieldHeadLabel(field) }}\n      </slot>\n      <template v-if=\"isSortable && !!scope.field.sortable && props.noSortableIcon === false\">\n        <slot\n          v-if=\"sortByModel?.find((el) => el.key === scope.field.key)?.order === 'asc'\"\n          v-bind=\"scope\"\n          :name=\"\n            slots[`sortAsc(${String(scope.field.key)})`]\n              ? (`sortAsc(${String(scope.field.key)})` as 'sortAsc()')\n              : 'sortAsc()'\n          \"\n        >\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            width=\"24\"\n            height=\"24\"\n            fill=\"currentColor\"\n            class=\"bi bi-arrow-up-short\"\n            viewBox=\"0 0 16 16\"\n            aria-hidden\n          >\n            <path\n              fill-rule=\"evenodd\"\n              d=\"M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5z\"\n            />\n          </svg>\n        </slot>\n        <slot\n          v-else-if=\"sortByModel?.find((el) => el.key === scope.field.key)?.order === 'desc'\"\n          v-bind=\"scope\"\n          :name=\"\n            slots[`sortDesc(${String(scope.field.key)})`]\n              ? (`sortDesc(${String(scope.field.key)})` as 'sortDesc()')\n              : 'sortDesc()'\n          \"\n        >\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            width=\"24\"\n            height=\"24\"\n            fill=\"currentColor\"\n            class=\"bi bi-arrow-down-short\"\n            viewBox=\"0 0 16 16\"\n            aria-hidden\n          >\n            <path\n              fill-rule=\"evenodd\"\n              d=\"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4z\"\n            />\n          </svg>\n        </slot>\n        <slot\n          v-else\n          v-bind=\"scope\"\n          :name=\"\n            slots[`sortDefault(${String(scope.field.key)})`]\n              ? (`sortDefault(${String(scope.field.key)})` as 'sortDefault()')\n              : 'sortDefault()'\n          \"\n        >\n          <svg\n            :style=\"{opacity: 0.4}\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            width=\"24\"\n            height=\"24\"\n            fill=\"currentColor\"\n            class=\"bi bi-arrow-up-short\"\n            viewBox=\"0 0 16 16\"\n            aria-hidden\n          >\n            <path\n              fill-rule=\"evenodd\"\n              d=\"M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5z\"\n            />\n          </svg>\n        </slot>\n      </template>\n    </template>\n    <template #custom-body=\"scope\">\n      <BTr\n        v-if=\"busyModel && slots['table-busy']\"\n        class=\"b-table-busy-slot\"\n        :class=\"getBusyRowClasses\"\n      >\n        <BTd :colspan=\"scope.fields.length\">\n          <slot name=\"table-busy\" />\n        </BTd>\n      </BTr>\n\n      <BTr\n        v-else-if=\"props.showEmpty === true && computedItems.length === 0\"\n        class=\"b-table-empty-row\"\n      >\n        <BTd :colspan=\"computedFields.length\">\n          <div role=\"alert\" aria-live=\"polite\">\n            <div class=\"text-center my-2\">\n              <slot v-if=\"isFilterableTable\" name=\"empty-filtered\" v-bind=\"emptySlotScope\">\n                {{ props.emptyFilteredText }}\n              </slot>\n              <slot v-else name=\"empty\" v-bind=\"emptySlotScope\">\n                {{ props.emptyText }}\n              </slot>\n            </div>\n          </div>\n        </BTd>\n      </BTr>\n    </template>\n  </BTableLite>\n</template>\n\n<script setup lang=\"ts\" generic=\"Items\">\nimport {useToNumber} from '@vueuse/core'\nimport {computed, onMounted, type Ref, ref, watch} from 'vue'\nimport {formatItem} from '../../utils/formatItem'\nimport BTableLite from './BTableLite.vue'\nimport BTd from './BTd.vue'\nimport BTr from './BTr.vue'\nimport {\n  type BTableSortBy,\n  type BTableSortByOrder,\n  isTableField,\n  isTableItem,\n  type NoProviderTypes,\n  type TableField,\n  type TableFieldFormatter,\n  type TableFieldRaw,\n  type TableItem,\n  type TableRowEvent,\n  type TableRowType,\n  type TableStrictClassValue,\n} from '../../types/TableTypes'\nimport {useDefaults} from '../../composables/useDefaults'\nimport type {BTableProps} from '../../types/ComponentProps'\nimport {get, pick, set} from '../../utils/object'\nimport {startCase} from '../../utils/stringUtils'\nimport type {LiteralUnion} from '../../types/LiteralUnion'\nimport {\n  btableLiteProps,\n  btableSimpleProps,\n  getDataLabelAttr,\n  getTableFieldHeadLabel,\n} from '../../utils/tableUtils'\nimport {useId} from '../../composables/useId'\n\nconst _props = withDefaults(\n  defineProps<Omit<BTableProps<Items>, 'sortBy' | 'busy' | 'selectedItems'>>(),\n  {\n    noSortableIcon: false,\n    perPage: Number.POSITIVE_INFINITY,\n    filter: undefined,\n    filterFunction: undefined,\n    mustSort: false,\n    filterable: undefined,\n    provider: undefined,\n    noProvider: undefined,\n    noProviderPaging: false,\n    noProviderSorting: false,\n    multisort: false,\n    noProviderFiltering: false,\n    noLocalSorting: false,\n    noSelectOnClick: false,\n    selectable: false,\n    stickySelect: false,\n    selectHead: true,\n    selectMode: 'multi',\n    selectionVariant: 'primary',\n    busyLoadingText: 'Loading...',\n    currentPage: 1,\n    // BTableLite props\n    items: () => [],\n    fields: () => [],\n    // All others use defaults\n    caption: undefined,\n    align: undefined,\n    footClone: undefined,\n    labelStacked: undefined,\n    showEmpty: false,\n    emptyText: 'There are no records to show',\n    emptyFilteredText: 'There are no records matching your request',\n    fieldColumnClass: undefined,\n    tbodyTrClass: undefined,\n    detailsTdClass: undefined,\n    headVariant: undefined,\n    headRowVariant: undefined,\n    footRowVariant: undefined,\n    footVariant: undefined,\n    modelValue: undefined,\n    primaryKey: undefined,\n    tbodyClass: undefined,\n    tfootClass: undefined,\n    tfootTrClass: undefined,\n    theadClass: undefined,\n    theadTrClass: undefined,\n    // End BTableLite props\n    // BTableSimple props\n    borderVariant: undefined,\n    variant: undefined,\n    bordered: undefined,\n    borderless: undefined,\n    captionTop: undefined,\n    dark: undefined,\n    hover: undefined,\n    id: undefined,\n    noBorderCollapse: undefined,\n    outlined: undefined,\n    fixed: undefined,\n    responsive: undefined,\n    stacked: undefined,\n    striped: undefined,\n    stripedColumns: undefined,\n    small: undefined,\n    stickyHeader: undefined,\n    // End BTableSimple props\n  }\n)\nconst props = useDefaults(_props, 'BTable')\n\nconst emit = defineEmits<{\n  'filtered': [value: Items[]]\n  'head-clicked': [\n    key: string,\n    field: (typeof computedFields.value)[0],\n    event: MouseEvent,\n    isFooter: boolean,\n  ]\n  'row-clicked': TableRowEvent<Items>\n  'row-dblclicked': TableRowEvent<Items>\n  'row-contextmenu': TableRowEvent<Items>\n  'row-hovered': TableRowEvent<Items>\n  'row-unhovered': TableRowEvent<Items>\n  'row-middle-clicked': TableRowEvent<Items>\n  'row-selected': [value: Items]\n  'row-unselected': [value: Items]\n  'sorted': [value: BTableSortBy<Items>]\n  'change': [value: Items[]]\n}>()\n\ntype SortSlotScope = {\n  label: string | undefined\n  column: LiteralUnion<keyof Items>\n  field: (typeof computedFields.value)[0]\n  isFoot: false\n}\n\nconst slots = defineSlots<{\n  // BTableLite\n  'thead-top'?: (props: {\n    columns: number\n    fields: typeof computedFields.value\n    selectAllRows: () => void\n    clearSelected: () => void\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  }) => any\n  [key: `head(${string})`]: (props: {\n    label: string | undefined\n    column: LiteralUnion<keyof Items>\n    field: (typeof computedFields.value)[0]\n    isFoot: false\n    selectAllRows: () => void\n    clearSelected: () => void\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  }) => any\n  'thead-sub'?: (\n    props: {\n      items: readonly Items[]\n      fields: typeof computedFields.value\n      field: (typeof computedFields.value)[0]\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  ) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  'top-row'?: (props: {columns: number; fields: typeof computedFields.value}) => any\n  [key: `cell(${string})`]: (props: {\n    value: unknown\n    unformatted: unknown\n    index: number\n    item: Items\n    field: (typeof computedFields.value)[0]\n    items: readonly Items[]\n    toggleDetails: () => void\n    detailsShowing: boolean\n    rowSelected: boolean\n    selectRow: (index?: number) => void\n    unselectRow: (index?: number) => void\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  }) => any\n  'row-details'?: (props: {\n    item: Items\n    toggleDetails: () => void\n    fields: typeof computedFields.value\n    index: number\n    rowSelected: boolean\n    selectRow: (index?: number) => void\n    unselectRow: (index?: number) => void\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  }) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  'bottom-row'?: (props: {columns: number; fields: typeof computedFields.value}) => any\n\n  [key: `foot(${string})`]: (props: {\n    label: string | undefined\n    column: LiteralUnion<keyof Items>\n    field: (typeof computedFields.value)[0]\n    isFoot: true\n    selectAllRows: () => void\n    clearSelected: () => void\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  }) => any\n  'custom-foot'?: (props: {\n    fields: typeof computedFields.value\n    items: readonly Items[]\n    columns: number\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  }) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  'table-caption'?: (props: Record<string, never>) => any\n\n  // end btable slots\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  [key: `sortAsc(${string})`]: (props: SortSlotScope) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  [key: `sortDesc(${string})`]: (props: SortSlotScope) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  [key: `sortDefault(${string})`]: (props: SortSlotScope) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  'table-busy'?: (props: Record<string, never>) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  'empty-filtered'?: (props: typeof emptySlotScope.value) => any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  'empty'?: (props: typeof emptySlotScope.value) => any\n}>()\n\nconst dynamicCellSlots = computed(\n  () => Object.keys(slots).filter((key) => key.startsWith('cell(')) as 'cell()'[]\n)\nconst dynamicFootSlots = computed(\n  () => Object.keys(slots).filter((key) => key.startsWith('foot(')) as 'foot()'[]\n)\n\nconst sortByModel = defineModel<BTableProps<Items>['sortBy']>('sortBy', {\n  default: undefined,\n})\nconst busyModel = defineModel<Exclude<BTableProps<Items>['busy'], undefined>>('busy', {\n  default: false,\n})\nconst selectedItemsModel = defineModel<Exclude<BTableProps<Items>['selectedItems'], undefined>>(\n  'selectedItems',\n  {\n    default: () => [],\n  }\n)\n\nconst computedId = useId(() => props.id)\n\nconst selectedItemsToSet = computed({\n  get: () => new Set(selectedItemsModel.value),\n  set: (val) => {\n    selectedItemsModel.value = [...val]\n  },\n})\n\nwatch(selectedItemsToSet, (newValue, oldValue) => {\n  Array.from(oldValue)\n    .filter((item) => !newValue.has(item))\n    .forEach((item) => {\n      emit('row-unselected', item)\n    })\n  Array.from(newValue)\n    .filter((item) => !oldValue.has(item))\n    .forEach((item) => {\n      emit('row-selected', item)\n    })\n})\n/**\n * This is to avoid the issue of directly mutating the array structure and to properly trigger the computed setter.\n * The utils also conveniently emit the proper events after\n */\nconst selectedItemsSetUtilities = {\n  add: (item: Items) => {\n    const value = new Set(selectedItemsToSet.value)\n    value.add(item)\n    selectedItemsToSet.value = value\n  },\n  clear: () => {\n    selectedItemsToSet.value.forEach((item) => {\n      selectedItemsSetUtilities.delete(item)\n    })\n  },\n  delete: (item: Items) => {\n    const value = new Set(selectedItemsToSet.value)\n    if (props.primaryKey) {\n      const pkey: string = props.primaryKey\n      selectedItemsModel.value.forEach((v, i) => {\n        const selectedKey = get(v, pkey)\n        const itemKey = get(item, pkey)\n\n        if (!!selectedKey && !!itemKey && selectedKey === itemKey) {\n          value.delete(selectedItemsModel.value[i])\n        }\n      })\n    } else {\n      value.delete(item)\n    }\n    selectedItemsToSet.value = value\n  },\n  set: (items: Items[]) => {\n    selectedItemsToSet.value = new Set(items)\n  },\n  has: (item: Items) => {\n    if (!props.primaryKey) return selectedItemsToSet.value.has(item)\n\n    // Resolver for when we are using primary keys\n    const pkey: string = props.primaryKey\n    for (const selected of selectedItemsToSet.value) {\n      const selectedKey = get(selected, pkey)\n      const itemKey = get(item, pkey)\n\n      if (!!selectedKey && !!itemKey && selectedKey === itemKey) return true\n    }\n    return false\n  },\n} as const\n\n/**\n * Only stores data that is fetched when using the provider\n */\nconst internalItems: Ref<Items[]> = ref([])\n\nconst perPageNumber = useToNumber(() => props.perPage, {method: 'parseInt'})\nconst currentPageNumber = useToNumber(() => props.currentPage, {method: 'parseInt'})\n\nconst isFilterableTable = computed(() => !!props.filter)\nconst usesProvider = computed(() => props.provider !== undefined)\nconst isSelecting = computed(() => selectedItemsToSet.value.size > 0)\n\nconst isSortable = computed(\n  () =>\n    sortByModel.value !== undefined ||\n    props.fields.some(\n      (field) => typeof field === 'object' && field !== null && field.sortable === true\n    )\n)\n\nconst computedFields = computed<TableField<Items>[]>(() =>\n  props.fields.map((el) => {\n    if (!isTableField<Items>(el)) {\n      const label = startCase(el as string)\n      return {\n        key: el as string,\n        label,\n        tdAttr: getDataLabelAttr(props, label),\n      }\n    }\n\n    const value = sortByModel.value?.find((sb) => el.key === sb.key)\n    const sortValue =\n      isSortable.value === false\n        ? undefined\n        : value === undefined\n          ? 'none'\n          : value.order === 'desc'\n            ? 'descending'\n            : value.order === 'asc'\n              ? 'ascending'\n              : 'none'\n\n    return {\n      ...(el as TableField<Items>),\n      thAttr: {\n        'aria-sort': sortValue,\n        ...el.thAttr,\n      },\n    }\n  })\n)\n\nconst tableClasses = computed(() => ({\n  'b-table-busy': busyModel.value,\n  'b-table-selectable': props.selectable,\n  'user-select-none': props.selectable && isSelecting.value,\n}))\n\nconst getBusyRowClasses = computed(() => [\n  props.tbodyTrClass\n    ? typeof props.tbodyTrClass === 'function'\n      ? props.tbodyTrClass(null, 'table-busy')\n      : props.tbodyTrClass\n    : null,\n])\nconst getFieldColumnClasses = (field: TableField) => [\n  {\n    'b-table-sortable-column': isSortable.value && field.sortable,\n  },\n]\n// TODO this class has issues if the table has a variant already applied\n// Also the row should technically have aria-selected . Both things could probably just use a function with tbodyTrAttrs\n// But functional tbodyTrAttrs are not supported yet\n// Also the stuff for resolving functions could probably be made a util\nconst getRowClasses = (item: Items | null, type: TableRowType): TableStrictClassValue => [\n  {\n    [`selected table-${props.selectionVariant}`]:\n      props.selectable && !!item && selectedItemsSetUtilities.has(item),\n  },\n  props.tbodyTrClass\n    ? typeof props.tbodyTrClass === 'function'\n      ? props.tbodyTrClass(item, type)\n      : props.tbodyTrClass\n    : null,\n]\n\nconst getFormatter = (value: TableField<Items>): TableFieldFormatter<Items> | undefined =>\n  typeof value.sortByFormatted === 'function' ? value.sortByFormatted : value.formatter\n\nconst computedItems = computed<Items[]>(() => {\n  // \"undefined\" values are set by us, we do this so we dont wipe out the comparer\n  const sortByItems = sortByModel.value?.filter((el) => !!el.order)\n\n  const mapItem = (item: Items): Items => {\n    if (\n      typeof item === 'object' &&\n      item !== null &&\n      Object.keys(item).some((key) => key.includes('.'))\n    ) {\n      let newItem: Partial<Items> = {}\n      for (const key in item) {\n        if (key.includes('.')) {\n          newItem = set(newItem, key, item[key])\n        } else {\n          newItem[key] = item[key]\n        }\n      }\n      return newItem as Items // This should be an items at this point\n    }\n    return item\n  }\n\n  const filterItem = (item: Items): boolean => {\n    if (!isTableItem(item)) return true\n\n    return Object.entries(item).some(([key, val]) => {\n      if (\n        val === null ||\n        val === undefined ||\n        key[0] === '_' ||\n        (!props.filterable?.includes(key) && !!props.filterable?.length)\n      )\n        return false\n\n      if (props.filterFunction && typeof props.filterFunction === 'function') {\n        return props.filterFunction(item, props.filter)\n      }\n\n      const realVal = (): string => {\n        const filterField = computedFields.value.find((el) => {\n          if (isTableField<Items>(el)) return el.key === key\n          return false\n        })\n        if (isTableField<Items>(filterField) && !!filterField.filterByFormatted) {\n          const formatter = getFormatter(filterField)\n          if (formatter) {\n            return String(formatter(val, String(filterField.key), item))\n          }\n        }\n        return typeof val === 'object' ? JSON.stringify(Object.values(val)) : val.toString()\n      }\n      const itemValue: string = realVal()\n      return itemValue.toLowerCase().includes(props.filter?.toLowerCase() ?? '')\n    })\n  }\n\n  const mappedItems = (usesProvider.value ? internalItems.value : props.items).reduce(\n    (acc, val) => {\n      const item = mapItem(val)\n      const shouldFilter =\n        isFilterableTable.value && (!usesProvider.value || props.noProviderFiltering)\n\n      if (!shouldFilter || filterItem(item)) acc.push(item)\n\n      return acc\n    },\n    [] as Items[]\n  )\n\n  if (\n    sortByItems?.length &&\n    ((isSortable.value === true && !usesProvider.value && !props.noLocalSorting) ||\n      (isSortable.value === true && usesProvider.value && props.noProviderSorting))\n  ) {\n    // Multi-sort\n    return mappedItems.sort((a, b) => {\n      for (let i = 0; i < sortByItems.length; i++) {\n        const {key, comparer, order} = sortByItems[i]\n        const getStringValue = (ob: Items): string => {\n          if (!isTableItem(ob)) return String(ob)\n\n          const sortField = computedFields.value.find((el) => {\n            if (isTableField<Items>(el)) return el.key === key\n\n            return false\n          })\n          const val = get(ob, key as keyof TableItem)\n          if (isTableField<Items>(sortField) && !!sortField.sortByFormatted) {\n            const formatter = getFormatter(sortField)\n            if (formatter) {\n              return String(formatItem(ob, String(sortField.key), formatter))\n            }\n          }\n          return typeof val === 'object' && val !== null\n            ? JSON.stringify(val)\n            : (val?.toString() ?? '')\n        }\n\n        const comparison = comparer\n          ? comparer(a, b, key)\n          : getStringValue(a).localeCompare(getStringValue(b), undefined, {numeric: true})\n\n        if (comparison !== 0) {\n          return order === 'asc' ? comparison : -comparison\n        }\n      }\n      return 0 // items are equal\n    })\n  }\n\n  return mappedItems\n})\n\nconst emptySlotScope = computed(() => ({\n  emptyFilteredText: props.emptyFilteredText,\n  emptyText: props.emptyText,\n  fields: computedFields.value,\n  items: computedItems.value,\n}))\n\nconst computedDisplayItems = computed<Items[]>(() => {\n  if (Number.isNaN(perPageNumber.value) || (usesProvider.value && !props.noProviderPaging)) {\n    return computedItems.value\n  }\n\n  return computedItems.value.slice(\n    (currentPageNumber.value - 1) * (perPageNumber.value || Number.POSITIVE_INFINITY),\n    currentPageNumber.value * (perPageNumber.value || Number.POSITIVE_INFINITY)\n  )\n})\n\nwatch(computedDisplayItems, (v) => {\n  emit('change', v)\n})\n\nconst handleRowSelection = (\n  row: Items,\n  index: number,\n  shiftClicked = false,\n  ctrlClicked = false,\n  metaClicked = false\n) => {\n  if (!props.selectable) return\n\n  if (props.selectMode === 'single' || props.selectMode === 'multi') {\n    // Do nothing when these items are held\n    if (shiftClicked || ctrlClicked) return\n    // Delete if item is in\n    if (selectedItemsSetUtilities.has(row)) {\n      selectedItemsSetUtilities.delete(row)\n    } else {\n      if (props.selectMode === 'single') {\n        selectedItemsSetUtilities.set([row])\n      } else {\n        selectedItemsSetUtilities.add(row)\n      }\n    }\n  } else {\n    if (ctrlClicked || metaClicked) {\n      // Delete if in the object\n      if (selectedItemsSetUtilities.has(row)) {\n        selectedItemsSetUtilities.delete(row)\n        // Otherwise add. Functions similarly to 'multi' at this point\n      } else {\n        selectedItemsSetUtilities.add(row)\n      }\n      // This is where range is different, due to the difference in shift\n    } else if (shiftClicked) {\n      const lastSelectedItem = [...selectedItemsToSet.value].pop()\n      const lastSelectedIndex = computedItems.value.findIndex((i) => i === lastSelectedItem)\n      const selectStartIndex = Math.min(lastSelectedIndex, index)\n      const selectEndIndex = Math.max(lastSelectedIndex, index)\n      const items = computedItems.value.slice(selectStartIndex, selectEndIndex + 1)\n      selectedItemsSetUtilities.set(items)\n      // If nothing is being held, then we just behave like it's single mode\n    } else {\n      selectedItemsSetUtilities.set([row])\n    }\n  }\n}\n\nconst onRowClick = (row: Items, index: number, e: MouseEvent) => {\n  if (props.noSelectOnClick === false) {\n    handleRowSelection(row, index, e.shiftKey, e.ctrlKey, e.metaKey)\n  }\n  emit('row-clicked', row, index, e)\n}\n\nconst handleFieldSorting = (field: TableField<Items>) => {\n  if (!isSortable.value) return\n\n  const fieldKey = typeof field === 'object' && field !== null ? field.key : field\n  const fieldSortable = typeof field === 'object' && field !== null ? field.sortable : false\n\n  if (!(isSortable.value === true && fieldSortable === true)) return\n\n  const resolveOrder = (val: BTableSortByOrder): BTableSortByOrder | undefined => {\n    if (val === 'asc') return 'desc'\n    if (val === undefined) return 'asc'\n    if (\n      props.mustSort === true ||\n      (Array.isArray(props.mustSort) && props.mustSort.includes(fieldKey as string))\n    )\n      return 'asc'\n    return undefined\n  }\n\n  const index = sortByModel.value?.findIndex((el) => el.key === fieldKey) ?? -1\n  const originalValue = sortByModel.value?.[index]\n  const updatedValue: BTableSortBy<Items> =\n    // If value is new, we default to ascending\n    // Otherwise we make a temp copy of the value\n    index === -1 || !originalValue ? {key: fieldKey as string, order: 'asc'} : {...originalValue}\n\n  /**\n   * @returns the updated value to emit for sorted\n   */\n  const handleMultiSort = (): BTableSortBy<Items> => {\n    sortByModel.value = sortByModel.value ?? []\n    const val = updatedValue\n    if (index === -1) {\n      sortByModel.value.push(val)\n    } else {\n      val.order = resolveOrder(val.order)\n      sortByModel.value.splice(index, 1, val)\n    }\n    return val\n  }\n\n  /**\n   * @returns the updated value to emit for sorted\n   */\n  const handleSingleSort = (): BTableSortBy<Items> => {\n    const val = {\n      ...updatedValue,\n      order: index === -1 ? updatedValue.order : resolveOrder(updatedValue.order),\n    }\n    const tmp = (sortByModel.value || []).map<BTableSortBy<Items>>((e) => ({\n      ...e,\n      order: undefined,\n    }))\n    if (index === -1) {\n      tmp.push(val)\n    } else {\n      tmp[index] = val\n    }\n    sortByModel.value = tmp\n    return val\n  }\n\n  // Then emit the returned updated value\n  emit('sorted', props.multisort === true ? handleMultiSort() : handleSingleSort())\n}\n\nconst onFieldHeadClick = (\n  fieldKey: string,\n  field: TableField<Items>,\n  event: Readonly<MouseEvent>,\n  isFooter = false\n) => {\n  emit('head-clicked', fieldKey, field, event, isFooter)\n  handleFieldSorting(field)\n}\n\nconst callItemsProvider = async () => {\n  if (!usesProvider.value || props.provider === undefined || busyModel.value) return\n  busyModel.value = true\n  const response = props.provider({\n    currentPage: currentPageNumber.value,\n    filter: props.filter,\n    sortBy: sortByModel.value,\n    perPage: perPageNumber.value,\n  })\n  try {\n    const items = response instanceof Promise ? await response : response\n\n    if (items === undefined) return\n    internalItems.value = items\n  } finally {\n    // Potential race condition could occur if the user explicitly sets the busy value to a different value while the response promise is executing\n    // which would have been the users choice.\n    // eslint-disable-next-line require-atomic-updates\n    busyModel.value = false\n  }\n}\n\nconst providerPropsWatch = async (prop: string, val: unknown, oldVal: unknown) => {\n  if (val === oldVal) return\n\n  //stop provide when paging\n  const inNoProvider = (key: NoProviderTypes) => props.noProvider?.includes(key) === true\n  const noProvideWhenPaging =\n    (prop === 'currentPage' || prop === 'perPage') &&\n    (inNoProvider('paging') || props.noProviderPaging === true)\n  const noProvideWhenFiltering =\n    prop === 'filter' && (inNoProvider('filtering') || props.noProviderFiltering === true)\n  const noProvideWhenSorting =\n    (prop === 'sortBy' || prop === 'sortDesc') &&\n    (inNoProvider('sorting') || props.noProviderSorting === true)\n\n  if (noProvideWhenPaging || noProvideWhenFiltering || noProvideWhenSorting) return\n\n  if (usesProvider.value === true) {\n    await callItemsProvider()\n  }\n\n  if (!(prop === 'currentPage' || prop === 'perPage')) {\n    emit('filtered', [...computedItems.value])\n  }\n}\n\nwatch(\n  () => props.filter,\n  (filter, oldFilter) => {\n    providerPropsWatch('filter', filter, oldFilter)\n\n    if (filter === oldFilter || usesProvider.value) return\n    if (!filter) {\n      emit('filtered', [...computedItems.value])\n    }\n  }\n)\nwatch(currentPageNumber, (val, oldVal) => {\n  providerPropsWatch('currentPage', val, oldVal)\n})\nwatch(perPageNumber, (val, oldVal) => {\n  providerPropsWatch('perPage', val, oldVal)\n})\nwatch(\n  sortByModel,\n  (val, oldVal) => {\n    providerPropsWatch('sortBy', val, oldVal)\n  },\n  {deep: true}\n)\n\nwatch(\n  () => props.provider,\n  (newValue) => {\n    // Reset the internal values if the provider stops getting used\n    if (newValue === undefined) {\n      internalItems.value = []\n      return\n    }\n    // Otherwise we should refresh the table on such a change\n    callItemsProvider()\n  }\n)\n\nonMounted(callItemsProvider)\n\nconst exposedSelectableUtilities = {\n  clearSelected: () => {\n    if (!props.selectable) return\n    selectedItemsSetUtilities.clear()\n  },\n  selectAllRows: () => {\n    if (!props.selectable || props.selectMode === 'single') return\n    selectedItemsToSet.value = new Set(computedItems.value)\n  },\n  selectRow: (index: number) => {\n    if (!props.selectable) return\n    const item = computedItems.value[index]\n    if (!item || selectedItemsSetUtilities.has(item)) return\n    if (props.selectMode === 'single') {\n      selectedItemsSetUtilities.set([item])\n    } else {\n      selectedItemsSetUtilities.add(item)\n    }\n  },\n  unselectRow: (index: number) => {\n    if (!props.selectable) return\n    const item = computedItems.value[index]\n    if (!item || !selectedItemsSetUtilities.has(item)) return\n    selectedItemsSetUtilities.delete(item)\n  },\n  isRowSelected: (index: number) => {\n    if (!props.selectable) return false\n    const item = computedItems.value[index]\n    return selectedItemsSetUtilities.has(item)\n  },\n} as const\n\nconst computedLiteProps = computed(() => ({\n  ...pick(props, [...btableLiteProps, ...btableSimpleProps]),\n  tableAttrs: {\n    ariaBusy: busyModel.value,\n  },\n  items: computedDisplayItems.value,\n  fields: computedFields.value as TableFieldRaw<Items>[],\n  tableClass: tableClasses.value,\n  tbodyTrClass: getRowClasses,\n  fieldColumnClass: getFieldColumnClasses,\n  id: computedId.value,\n}))\n\ndefineExpose({\n  // The row selection methods are really for compat. Users should probably use the v-model though\n  ...exposedSelectableUtilities,\n  items: computedItems,\n  refresh: callItemsProvider,\n})\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}