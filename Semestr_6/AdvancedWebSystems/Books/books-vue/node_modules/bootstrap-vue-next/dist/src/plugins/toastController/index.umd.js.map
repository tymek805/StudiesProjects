{"version":3,"file":"index.umd.js","sources":["../../../../src/plugins/toastController/index.ts"],"sourcesContent":["import {markRaw, type Plugin, ref, toRef, watch} from 'vue'\nimport {toastPluginKey} from '../../utils/keys'\nimport type {ContainerPosition} from '../../types/Alignment'\nimport type {\n  ControllerKey,\n  ToastOrchestratorArrayValue,\n  ToastOrchestratorShowParam,\n} from '../../types/ComponentOrchestratorTypes'\n\nconst posDefault: ContainerPosition = 'top-end'\n\nexport const toastPlugin: Plugin = {\n  install(app) {\n    const toasts = ref<ToastOrchestratorArrayValue[]>([])\n\n    const _isAppend = ref(false)\n\n    const _setIsAppend = (value: boolean) => {\n      _isAppend.value = value\n    }\n\n    /**\n     * @returns {ControllerKey} If `id` is passed to props, it will use that id, otherwise, a symbol will be created that corresponds to its unique id.\n     * You can pass this id to the hide function to force a Toast to hide\n     */\n    const show = (obj: ToastOrchestratorShowParam = {}): ControllerKey => {\n      const resolvedProps = toRef(obj.props)\n\n      const _self = resolvedProps.value?.id || Symbol('Toast controller')\n\n      const toastToAdd: ToastOrchestratorArrayValue = {\n        component: !obj.component ? undefined : markRaw(obj.component),\n        props: {\n          ...resolvedProps.value,\n          pos: resolvedProps.value?.pos || posDefault,\n          _modelValue: resolvedProps.value?.value || 5000,\n          _self,\n        },\n      }\n\n      if (\n        resolvedProps.value?.appendToast !== undefined\n          ? resolvedProps.value.appendToast\n          : _isAppend.value\n      ) {\n        toasts.value.push(toastToAdd)\n      } else {\n        toasts.value.unshift(toastToAdd)\n      }\n\n      watch(resolvedProps, (newValue) => {\n        const previousIndex = toasts.value.findIndex((el) => el.props._self === _self)\n        if (previousIndex === -1) return\n        toasts.value.splice(previousIndex, 1, {\n          component: !obj.component ? undefined : markRaw(obj.component),\n          props: {\n            ...toasts.value[previousIndex].props,\n            ...newValue,\n            _modelValue: newValue?.value || toasts.value[previousIndex].props._modelValue || 5000,\n          },\n        })\n      })\n\n      return _self\n    }\n\n    /**\n     * You can get the symbol param from the return value from the show method, or use props.id\n     */\n    const remove = (self: ControllerKey) => {\n      toasts.value = toasts.value.filter((el) => el.props._self !== self)\n    }\n\n    /**\n     * You can get the symbol param from the return value from the show method, or use props.id\n     */\n    const leave = (self: ControllerKey) => {\n      const toastIndex = toasts.value.findIndex((el) => el.props._self === self)\n      if (toastIndex === -1) return\n      toasts.value.splice(toastIndex, 1, {\n        component: !toasts.value[toastIndex].component\n          ? undefined\n          : markRaw(toasts.value[toastIndex].component as object),\n        props: {\n          ...toasts.value[toastIndex].props,\n          _modelValue: false,\n        },\n      })\n    }\n\n    app.provide(toastPluginKey, {\n      _setIsAppend,\n      toasts,\n      show,\n      remove,\n      leave,\n    })\n  },\n}\n"],"names":["toastPlugin","install","app","toasts","ref","_isAppend","provide","toastPluginKey","_setIsAppend","value","show","obj","resolvedProps","toRef","props","_self","_a","id","Symbol","toastToAdd","component","markRaw","pos","_b","_modelValue","_c","_d","appendToast","push","unshift","newValue","previousIndex","findIndex","el","splice","remove","self","filter","leave","toastIndex"],"mappings":"8IAWaA,EAAsB,CACjC,OAAAC,CAAQC,GACA,MAAAC,EAASC,EAAmCA,IAAA,IAE5CC,EAAYD,OAAI,GA2ElBF,EAAAI,QAAQC,iBAAgB,CAC1BC,aA1EoBC,IACpBJ,EAAUI,MAAQA,CAAA,EA0ElBN,SACAO,KApEW,CAACC,EAAkC,kBACxC,MAAAC,EAAgBC,EAAAA,MAAMF,EAAIG,OAE1BC,GAAQ,OAAAC,EAAcJ,EAAAH,YAAO,EAAAO,EAAAC,KAAMC,OAAO,oBAE1CC,EAA0C,CAC9CC,UAAYT,EAAIS,UAAwBC,EAAAA,QAAQV,EAAIS,gBAAxB,EAC5BN,MAAO,IACFF,EAAcH,MACjBa,KAAK,OAAAC,EAAAX,EAAcH,YAAd,EAAAc,EAAqBD,MAzBE,UA0B5BE,aAAa,OAAAC,EAAAb,EAAcH,YAAd,EAAAgB,EAAqBhB,QAAS,IAC3CM,UA2BG,YAtBgC,KAArC,OAAAW,EAAAd,EAAcH,YAAO,EAAAiB,EAAAC,aACjBf,EAAcH,MAAMkB,YACpBtB,EAAUI,OAEPN,EAAAM,MAAMmB,KAAKT,GAEXhB,EAAAM,MAAMoB,QAAQV,WAGjBP,GAAgBkB,IACd,MAAAC,EAAgB5B,EAAOM,MAAMuB,WAAWC,GAAOA,EAAGnB,MAAMC,QAAUA,KAC9C,IAAtBgB,GACG5B,EAAAM,MAAMyB,OAAOH,EAAe,EAAG,CACpCX,UAAYT,EAAIS,UAAwBC,EAAAA,QAAQV,EAAIS,gBAAxB,EAC5BN,MAAO,IACFX,EAAOM,MAAMsB,GAAejB,SAC5BgB,EACHN,mBAAaM,WAAUrB,QAASN,EAAOM,MAAMsB,GAAejB,MAAMU,aAAe,MAEpF,IAGIT,CAAA,EA+BPoB,OAzBcC,IACPjC,EAAAM,MAAQN,EAAOM,MAAM4B,QAAQJ,GAAOA,EAAGnB,MAAMC,QAAUqB,GAAI,EAyBlEE,MAnBaF,IACP,MAAAG,EAAapC,EAAOM,MAAMuB,WAAWC,GAAOA,EAAGnB,MAAMC,QAAUqB,KAC9C,IAAnBG,GACGpC,EAAAM,MAAMyB,OAAOK,EAAY,EAAG,CACjCnB,UAAYjB,EAAOM,MAAM8B,GAAYnB,UAEjCC,EAAAA,QAAQlB,EAAOM,MAAM8B,GAAYnB,gBADjC,EAEJN,MAAO,IACFX,EAAOM,MAAM8B,GAAYzB,MAC5BU,aAAa,IAEhB,GASF"}