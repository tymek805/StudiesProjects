"use strict";const e=require("vue"),a=require("./event-UQ02889E.js"),t=require("./constants-B1zBgSOo.js"),l=require("./index-DSoA9-GW.js"),o=require("./useDefaults-_waRUo1X.js"),r=require("./useId-BOa4n5pr.js"),u=require("./keys-C2BcfuxJ.js"),n=require("./index-D8BEsrjv.js"),i=["lang","tabindex","title"],d=["name","form","value"],s=["id","dir","tabindex","aria-label","aria-invalid","aria-required","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext"],v=1,m=100,c=1,p=500,b=100,f=10,h=4,y=e.defineComponent({__name:"BFormSpinbutton",props:e.mergeModels({ariaControls:{default:void 0},ariaLabel:{default:void 0},disabled:{type:Boolean,default:!1},form:{default:void 0},formatterFn:{type:Function,default:void 0},id:{default:void 0},inline:{type:Boolean,default:!1},labelDecrement:{default:"Decrement"},labelIncrement:{default:"Increment"},locale:{default:void 0},max:{default:m},min:{default:v},name:{default:void 0},placeholder:{default:void 0},readonly:{type:Boolean,default:!1},repeatDelay:{default:p},repeatInterval:{default:b},repeatStepMultiplier:{default:h},repeatThreshold:{default:f},required:{type:Boolean,default:!1},size:{default:void 0},state:{type:[Boolean,null],default:null},step:{default:c},vertical:{type:Boolean,default:!1},wrap:{type:Boolean,default:!1}},{modelValue:{default:null},modelModifiers:{}}),emits:e.mergeModels(["change"],["update:modelValue"]),setup(m,{emit:y}){const g=[t.CODE_UP,t.CODE_DOWN,t.CODE_HOME,t.CODE_END,t.CODE_PAGEUP,t.CODE_PAGEDOWN],E=m,N=o.useDefaults(E,"BFormSpinbutton"),D=y,w=e.useModel(m,"modelValue"),x=e.useTemplateRef("_element"),{focused:O}=l.useFocus(x),P=r.useId((()=>N.id),"spinbutton"),C=e.computed((()=>({disabled:N.disabled,readonly:N.readonly,focus:O.value,"d-inline-flex":N.inline||N.vertical,"d-flex":!N.inline&&!N.vertical,"align-items-stretch":!N.vertical,"flex-column":N.vertical,[`form-control-${N.size}`]:void 0!==N.size}))),_=e.computed((()=>({"d-flex":N.vertical,"align-self-center":!N.vertical,"align-items-center":N.vertical,"border-top":N.vertical,"border-bottom":N.vertical,"border-start":!N.vertical,"border-end":!N.vertical})));let M,B,k=!1;const T=n.useToNumber((()=>N.step)),I=e.computed((()=>Number.isNaN(T.value)?c:T.value)),q=n.useToNumber((()=>N.min)),F=e.computed((()=>Number.isNaN(q.value)?v:q.value)),z=n.useToNumber((()=>N.max)),A=e.computed((()=>{const e=I.value,a=F.value;return Math.floor((z.value-a)/e)*e+a})),S=n.useToNumber((()=>N.repeatDelay),{nanToZero:!0,method:"parseInt"}),V=e.computed((()=>S.value>0?S.value:p)),K=n.useToNumber((()=>N.repeatInterval),{nanToZero:!0,method:"parseInt"}),j=e.computed((()=>K.value>0?K.value:b)),R=n.useToNumber((()=>N.repeatThreshold),{nanToZero:!0,method:"parseInt"}),U=e.computed((()=>Math.max(Number.isNaN(R.value)?f:R.value,1))),G=n.useToNumber((()=>N.repeatStepMultiplier),{nanToZero:!0,method:"parseInt"}),W=e.computed((()=>Math.max(Number.isNaN(G.value)?h:G.value,1))),Z=e.computed((()=>{const e=I.value;return Math.floor(e)===e?0:(e.toString().split(".")[1]||"").length})),$=e.computed((()=>Math.pow(10,Z.value||0))),L=e.computed((()=>null===w.value?"":w.value.toFixed(Z.value))),{isRtl:H,locale:X}=(()=>{const a=e.inject(u.rtlPluginKey);return e.onMounted((()=>{e.watch((()=>null==a?void 0:a.locale.value),(e=>{document.documentElement.setAttribute("lang",e??"")}),{immediate:!0}),e.watch((()=>null==a?void 0:a.isRtl.value),(e=>{document.documentElement.setAttribute("dir",e?"rtl":"ltr")}),{immediate:!0})})),{...a}})(),J=e.computed((()=>{const e=[(N.locale??(null==X?void 0:X.value))||"locale"];return new Intl.NumberFormat(e).resolvedOptions().locale})),Q=e.computed((()=>N.formatterFn??new Intl.NumberFormat(J.value,{style:"decimal",useGrouping:!1,minimumIntegerDigits:1,minimumFractionDigits:Z.value,maximumFractionDigits:Z.value,notation:"standard"}).format)),Y=e=>{let{value:a}=w;if(!N.disabled&&null!==a){const t=I.value*e,l=F.value,o=A.value,r=$.value,{wrap:u}=N;a=Math.round((a-l)/t)*t+l+t,a=Math.round(a*r)/r,w.value=a>o?u?l:o:a<l?u?o:l:a}},ee=(e=1)=>{null!==w.value?Y(1*e):w.value=F.value},ae=(e=1)=>{null!==w.value?Y(-1*e):w.value=N.wrap?A.value:F.value};l.onKeyStroke(g,(e=>{const{code:l,altKey:o,ctrlKey:r,metaKey:u}=e;if(!(N.disabled||N.readonly||o||r||u||(a.stopEvent(e,{immediatePropagation:!0}),k))){if(ue(),[t.CODE_UP,t.CODE_DOWN].includes(l))return k=!0,l===t.CODE_UP?void te(e,ee):void(l===t.CODE_DOWN&&te(e,ae));l!==t.CODE_PAGEUP?l!==t.CODE_PAGEDOWN?l!==t.CODE_HOME?l===t.CODE_END&&(w.value=A.value):w.value=F.value:ae(W.value):ee(W.value)}}),{target:x,eventName:"keydown"}),l.onKeyStroke(g,(e=>{const{altKey:t,ctrlKey:l,metaKey:o}=e;N.disabled||N.readonly||t||l||o||(a.stopEvent(e,{immediatePropagation:!0}),ue(),k=!1,D("change",w.value))}),{target:x,eventName:"keyup"});const te=(e,a)=>{const{type:t}=e||{};if(!N.disabled&&!N.readonly){if(le(e)&&"mousedown"===t&&e.button)return;ue(),a(1);const l=U.value,o=W.value,r=V.value,u=j.value;M=setTimeout((()=>{let e=0;B=setInterval((()=>{a(e<l?1:o),e++}),u)}),r)}},le=e=>"mouseup"===e.type||"mousedown"===e.type,oe=e=>{le(e)&&"mouseup"===e.type&&e.button||(a.stopEvent(e,{immediatePropagation:!0}),ue(),re(!1),D("change",w.value))},re=e=>{try{a.eventOnOff(e,[document.body,"mouseup",oe,!1]),a.eventOnOff(e,[document.body,"touchend",oe,!1])}catch{}},ue=()=>{clearTimeout(M),clearInterval(B),M=void 0,B=void 0},ne=e.computed((()=>{const e={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-plus",viewBox:"0 0 16 16"},t={d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"},l={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-dash",viewBox:"0 0 16 16"},o={d:"M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8z"},r={class:[{"py-0":!N.vertical},"btn","btn-sm","border-0","rounded-0"],tabindex:"-1",type:"button",disabled:N.disabled||N.readonly,"aria-disabled":!(!N.disabled&&!N.readonly)||void 0,"aria-controls":P.value},u={"aria-hidden":!0,scale:O.value?1.5:1.25},n=(e,t)=>{N.disabled||N.readonly||(a.stopEvent(e,{immediatePropagation:!0}),re(!0),O.value=!0,te(e,t))},i={button:{...r,"aria-label":N.labelIncrement||void 0,"aria-keyshortcuts":"ArrowUp"},svg:{...u,...e},path:{...t},slot:{name:"increment"},handler:e=>n(e,ee)},d={button:{...r,"aria-label":N.labelDecrement||void 0,"aria-keyshortcuts":"ArrowDown"},svg:{...u,...l},path:{...o},slot:{name:"decrement"},handler:e=>n(e,ae)};return{top:{...N.vertical?i:d},bottom:{...N.vertical?d:i}}}));return(a,t)=>(e.openBlock(),e.createElementBlock("div",{ref:"_element",class:e.normalizeClass(["b-form-spinbutton form-control",C.value]),role:"group",lang:J.value,tabindex:e.unref(N).disabled?void 0:"-1",title:e.unref(N).ariaLabel,onClick:t[4]||(t[4]=e=>O.value=!0)},[e.renderSlot(a.$slots,ne.value.top.slot.name,{hasFocus:e.unref(O)},(()=>[e.createElementVNode("button",e.mergeProps(ne.value.top.button,{onMousedown:t[0]||(t[0]=(...e)=>ne.value.top.handler&&ne.value.top.handler(...e)),onTouchstart:t[1]||(t[1]=(...e)=>ne.value.top.handler&&ne.value.top.handler(...e))}),[(e.openBlock(),e.createElementBlock("svg",e.normalizeProps(e.guardReactiveProps(ne.value.top.svg)),[e.createElementVNode("path",e.normalizeProps(e.guardReactiveProps(ne.value.top.path)),null,16)],16))],16)])),e.unref(N).name&&!e.unref(N).disabled?(e.openBlock(),e.createElementBlock("input",{key:"hidden",type:"hidden",name:e.unref(N).name,form:e.unref(N).form,value:L.value},null,8,d)):e.createCommentVNode("",!0),e.createElementVNode("output",{id:e.unref(P),key:"output",class:e.normalizeClass(["flex-grow-1",_.value]),dir:e.unref(H)?"rtl":"ltr",tabindex:e.unref(N).disabled?void 0:"0",role:"spinbutton","aria-live":"off","aria-label":e.unref(N).ariaLabel||void 0,"aria-invalid":!!(!1===e.unref(N).state||null!==!w.value&&e.unref(N).required)||void 0,"aria-required":!!e.unref(N).required||void 0,"aria-valuemin":F.value,"aria-valuemax":A.value,"aria-valuenow":null!==w.value?w.value:void 0,"aria-valuetext":null!==w.value?Q.value(w.value):void 0},[e.createElementVNode("bdi",null,e.toDisplayString((null!==w.value?Q.value(w.value):e.unref(N).placeholder)||""),1)],10,s),e.renderSlot(a.$slots,ne.value.bottom.slot.name,{hasFocus:e.unref(O)},(()=>[e.createElementVNode("button",e.mergeProps(ne.value.bottom.button,{onMousedown:t[2]||(t[2]=(...e)=>ne.value.bottom.handler&&ne.value.bottom.handler(...e)),onTouchstart:t[3]||(t[3]=(...e)=>ne.value.bottom.handler&&ne.value.bottom.handler(...e))}),[(e.openBlock(),e.createElementBlock("svg",e.normalizeProps(e.guardReactiveProps(ne.value.bottom.svg)),[e.createElementVNode("path",e.normalizeProps(e.guardReactiveProps(ne.value.bottom.path)),null,16)],16))],16)]))],10,i))}});exports._sfc_main=y;
//# sourceMappingURL=BFormSpinbutton.vue_vue_type_script_setup_true_lang-ReXgTGP8.js.map
